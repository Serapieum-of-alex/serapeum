%% Class Diagram: Tool System
classDiagram
  class ToolMetadata {
    +get_schema()
    +tool_schema_str()
    +get_name()
    +to_openai_tool(skip_length_check=false)
  }

  class ToolOutput {
    +tool_name: str
    +content: str
    +chunks: List[Chunk]
    +is_error: bool
    +__str__()
  }

  class ToolCallArguments {
    +arguments: dict
  }

  class BaseTool {
    +metadata() ToolMetadata
    +__call__(input_values) ToolOutput
  }

  class AsyncBaseTool {
    +__call__(*args, **kwargs) ToolOutput
    +call(input_values) ToolOutput
    +acall(input_values) ToolOutput
  }

  class BaseToolAsyncAdapter {
    +tool: BaseTool
    +metadata() ToolMetadata
    +call(input_values)
    +acall(input_values)
  }

  class SyncAsyncConverter {
    +to_async(fn)
    +async_to_sync(fn)
  }

  class CallableTool {
    +from_function(func, name, description, return_direct, tool_schema, tool_metadata, default_arguments) CallableTool
    +from_model(output_cls) CallableTool
    +metadata() ToolMetadata
    +sync_func()
    +async_func()
    +input_func()
    +__call__(*args, **kwargs) ToolOutput
    +call(*args, **kwargs) ToolOutput
    +acall(*args, **kwargs) ToolOutput
  }

  BaseTool <|-- AsyncBaseTool
  AsyncBaseTool <|-- CallableTool
  AsyncBaseTool <|-- BaseToolAsyncAdapter

  CallableTool ..> ToolMetadata : uses
  CallableTool ..> SyncAsyncConverter : adapts
  BaseTool ..> ToolOutput : returns
  AsyncBaseTool ..> ToolOutput : returns
  CallableTool ..> ToolOutput : returns
  CallableTool ..> ToolCallArguments : parses

