
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LLM package">
      
      
      
        <link rel="canonical" href="https://serapieum-of-alex.github.io/Serapeum/develop/reference/core/embeddings/module/">
      
      
        <link rel="prev" href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_state/">
      
      
        <link rel="next" href="../../tools/tools/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Core Embeddings - Serapeum</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/panzoom.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <meta name="panzoom-theme" content="material">
<meta name="panzoom-data" content='{"selectors": [".mermaid", ".d2"], "initial_zoom_level": 1.0}'> </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#core-embeddings" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Serapeum" class="md-header__button md-logo" aria-label="Serapeum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Serapeum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core Embeddings
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Serapieum-of-alex/Serapeum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Serapieum-of-alex/Serapeum
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../developer-guide/installation/" class="md-tabs__link">
          
  
  
    
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../overview/codebase-map/" class="md-tabs__link">
          
  
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../architecture/diagrams.md" class="md-tabs__link">
          
  
  
    
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../llms/llm-classes-comparison/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../providers/ollama/general/" class="md-tabs__link">
          
  
  
    
  
  Providers

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../change-log/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Serapeum" class="md-nav__button md-logo" aria-label="Serapeum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Serapeum
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Serapieum-of-alex/Serapeum" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Serapieum-of-alex/Serapeum
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Developer Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developer Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-guide/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-guide/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-guide/taskfile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Taskfile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/codebase-map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Codebase Map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../architecture/diagrams.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    llms
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    llms
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/llm-classes-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Classes Comparison
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2" id="__nav_5_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    orchestrators
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    orchestrators
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_1" id="__nav_5_1_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Text Completion LLM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Text Completion LLM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/text_completion_llm_sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/text_completion_llm_class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/text_completion_llm_dataflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/text_completion_llm_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/text_completion_llm/text_completion_llm_state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_2_2" id="__nav_5_1_1_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tool Orchestrating LLM
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tool Orchestrating LLM
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_dataflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    embeddings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    embeddings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Core Embeddings
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Embeddings
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-embedding-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Embedding module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serapeum.core.embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      
        embeddings
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="embeddings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseEmbedding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.acall" class="md-nav__link">
    <span class="md-ellipsis">
      
        acall
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_agg_embedding_from_queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_agg_embedding_from_queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_query_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_query_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_text_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_text_embedding_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_agg_embedding_from_queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_agg_embedding_from_queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_query_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_query_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text_embedding_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        similarity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseNode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        hash
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.linked_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        linked_nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_content
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_metadata_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_metadata_str
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_node_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_node_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.set_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_content
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        CallMixin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CallMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin.acall" class="md-nav__link">
    <span class="md-ellipsis">
      
        acall
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinkedNodes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LinkedNodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.source_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        source_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        as_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.create" class="md-nav__link">
    <span class="md-ellipsis">
      
        create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.validate_children_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_children_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.validate_single_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_single_node
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MetadataMode" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetadataMode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        MockEmbedding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MockEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding.class_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        class_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding.validate_embed_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_embed_dim
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeInfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeInfo
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeInfo.class_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        class_name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeType" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeType
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/callable_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CallableTools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Ollama
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ollama
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/ollama_sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/ollama_class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/ollama_dataflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/ollama_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/ollama/ollama_state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Add New Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Add New Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../providers/add_new_providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instructions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../change-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Change-log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-embedding-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Embedding module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serapeum.core.embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      
        embeddings
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="embeddings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseEmbedding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.acall" class="md-nav__link">
    <span class="md-ellipsis">
      
        acall
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_agg_embedding_from_queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_agg_embedding_from_queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_query_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_query_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_text_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        aget_text_embedding_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_agg_embedding_from_queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_agg_embedding_from_queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_query_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_query_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding_batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_text_embedding_batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseEmbedding.similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        similarity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseNode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.hash" class="md-nav__link">
    <span class="md-ellipsis">
      
        hash
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.linked_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        linked_nodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_content
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_metadata_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_metadata_str
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_node_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_node_info
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.get_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.BaseNode.set_content" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_content
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        CallMixin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CallMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.CallMixin.acall" class="md-nav__link">
    <span class="md-ellipsis">
      
        acall
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinkedNodes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LinkedNodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.source_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        source_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        as_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.create" class="md-nav__link">
    <span class="md-ellipsis">
      
        create
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.validate_children_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_children_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.LinkedNodes.validate_single_node" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_single_node
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MetadataMode" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetadataMode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        MockEmbedding
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MockEmbedding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding.class_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        class_name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.MockEmbedding.validate_embed_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_embed_dim
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeInfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeInfo
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeInfo.class_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        class_name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serapeum.core.embeddings.NodeType" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeType
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Serapieum-of-alex/Serapeum/edit/master/docs/reference/core/embeddings/module.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Serapieum-of-alex/Serapeum/raw/master/docs/reference/core/embeddings/module.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="core-embeddings"><a class="toclink" href="#core-embeddings">Core Embeddings</a><a class="headerlink" href="#core-embeddings" title="Permanent link">#</a></h1>
<h2 id="core-embedding-module"><a class="toclink" href="#core-embedding-module">Core Embedding module</a><a class="headerlink" href="#core-embedding-module" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-module">



<h2 id="serapeum.core.embeddings" class="doc doc-heading"><a href="#serapeum.core.embeddings" class="toclink">
            <code>serapeum.core.embeddings</code>


</a><a href="#serapeum.core.embeddings" class="headerlink" title="Permanent link">#</a></h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.BaseEmbedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding" class="toclink">
            <code>BaseEmbedding</code>


</a><a href="#serapeum.core.embeddings.BaseEmbedding" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="serapeum.core.types.SerializableModel">SerializableModel</span></code>, <code><a class="autorefs autorefs-internal" title="&lt;code&gt;CallMixin&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.CallMixin&lt;/code&gt;)" href="#serapeum.core.embeddings.CallMixin">CallMixin</a></code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Abstract base class for all embedding model implementations.</p>
<p>This class provides the core interface and shared functionality for converting
text into dense vector embeddings. It supports both query and document embedding,
with optional caching, batching, and async operations.</p>
<p>Subclasses must implement the abstract methods for generating embeddings from
text and queries. The class handles caching, batching, and progress tracking
automatically.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseEmbedding.model_name">model_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the embedding model. Defaults to "unknown".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseEmbedding.batch_size">batch_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of texts to process in each batch. Must be between
1 and 2048. Defaults to 10.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseEmbedding.num_workers">num_workers</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of worker threads for async operations. If None,
uses default async behavior without worker pooling.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseEmbedding.cache_store">cache_store</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional key-value store for caching embeddings. Must implement
get(), aget(), put(), and aput() methods. When provided, embeddings are
cached using a key combining text and model configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This is an abstract base class and cannot be instantiated directly.
Subclasses must implement _get_query_embedding, _aget_query_embedding,
and _get_text_embedding methods.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>serapeum.providers.ollama.embeddings.OllamaEmbedding: Concrete implementation
    for Ollama embedding models.
CallMixin: Mixin providing <strong>call</strong> and acall methods.
SerializableModel: Base Pydantic model with serialization support.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseEmbedding</span><span class="p">(</span><span class="n">SerializableModel</span><span class="p">,</span> <span class="n">CallMixin</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for all embedding model implementations.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    This class provides the core interface and shared functionality for converting</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    text into dense vector embeddings. It supports both query and document embedding,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    with optional caching, batching, and async operations.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    Subclasses must implement the abstract methods for generating embeddings from</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    text and queries. The class handles caching, batching, and progress tracking</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    automatically.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        model_name: Name of the embedding model. Defaults to &quot;unknown&quot;.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        batch_size: Number of texts to process in each batch. Must be between</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            1 and 2048. Defaults to 10.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        num_workers: Number of worker threads for async operations. If None,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            uses default async behavior without worker pooling.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        cache_store: Optional key-value store for caching embeddings. Must implement</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            get(), aget(), put(), and aput() methods. When provided, embeddings are</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            cached using a key combining text and model configuration.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        This is an abstract base class and cannot be instantiated directly.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        Subclasses must implement _get_query_embedding, _aget_query_embedding,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        and _get_text_embedding methods.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        serapeum.providers.ollama.embeddings.OllamaEmbedding: Concrete implementation</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            for Ollama embedding models.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        CallMixin: Mixin providing __call__ and acall methods.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        SerializableModel: Base Pydantic model with serialization support.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;unknown&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The name of the embedding model.&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_EMBED_BATCH_SIZE</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The batch size for embedding calls.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">le</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The number of workers to use for async embedding calls.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">cache_store</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="s2">&quot;Key-value store for caching embeddings. Must implement get(), aget(), &quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="s2">&quot;put(), and aput() methods with signature: get(key: str, collection: str) -&gt; dict | None. &quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="s2">&quot;When provided, embeddings are cached using a key that combines the text and model configuration. &quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="s2">&quot;If None, embeddings are not cached and will be recomputed on each call.&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="p">),</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a unique cache key combining text and model configuration.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        The cache key includes both the input text and a JSON representation of</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        the model configuration, ensuring that different models or configurations</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        don&#39;t share cached embeddings. Sensitive fields like api_key are excluded.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            text: Input text to generate a cache key for.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            Cache key string in format &quot;{text}::{model_config_json}&quot;.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            The following fields are excluded from the cache key:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                - api_key: Sensitive credential information</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                - cache_store: Avoid circular reference in serialization</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">model_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">model_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;api_key&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">model_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cache_store&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Avoid circular reference</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="c1"># Create a deterministic string representation</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">model_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">model_dict</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">::</span><span class="si">{</span><span class="n">model_str</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed the input query synchronously (internal implementation).</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        This is an internal method that subclasses must implement to provide</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        the core query embedding functionality. The public method get_query_embedding()</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        handles caching and calls this method when needed.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        Query embeddings may use special instructions or prefixes depending on the</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        model. For example, some models prepend &quot;Represent the question for</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        retrieving supporting documents: &quot; to optimize for retrieval tasks.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            query: Query text to embed.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            get_query_embedding: Public method that handles caching and delegates</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">                to this method.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            _aget_query_embedding: Async version of this method.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed the input query asynchronously (internal implementation).</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        This is an internal async method that subclasses must implement to provide</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        the core query embedding functionality. The public method aget_query_embedding()</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        handles caching and calls this method when needed.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            query: Query text to embed.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            aget_query_embedding: Public async method that handles caching and</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                delegates to this method.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            _get_query_embedding: Sync version of this method.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate an embedding vector for a query string.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Embeds the input query into a dense vector representation optimized for</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        retrieval tasks. When caching is enabled, checks the cache first and stores</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        new embeddings automatically.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Depending on the model, a special instruction may be prepended to the raw</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        query string to optimize for specific tasks. For example, some models use</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        &quot;Represent the question for retrieving supporting documents: &quot;.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            query: Query text to embed.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            aget_query_embedding: Async version of this method.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">            get_text_embedding: For embedding document text (not queries).</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">            _get_query_embedding: Internal implementation method.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">query_embedding</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="n">query_embedding</span> <span class="o">=</span> <span class="n">cached</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="k">if</span> <span class="n">query_embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">query_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">query_embedding</span><span class="p">},</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">return</span> <span class="n">query_embedding</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an embedding vector for a query string.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Async version of get_query_embedding(). Embeds the input query into a dense</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        vector representation with cache support.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            query: Query text to embed.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">            get_query_embedding: Sync version of this method.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            aget_text_embedding: For embedding document text asynchronously.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            _aget_query_embedding: Internal async implementation method.</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">query_embedding</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">cached</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aget</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="n">query_embedding</span> <span class="o">=</span> <span class="n">cached</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="k">if</span> <span class="n">query_embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">query_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aput</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">query_embedding</span><span class="p">},</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                <span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="k">return</span> <span class="n">query_embedding</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_agg_embedding_from_queries</span><span class="p">(</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">queries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="n">agg_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a single aggregated embedding from multiple query strings.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        Embeds each query individually and then combines them using an aggregation</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        function. This is useful for creating a unified representation from multiple</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        related queries or questions.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            queries: List of query strings to embed and aggregate.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            agg_fn: Optional aggregation function that takes a list of embeddings</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">                and returns a single embedding. Defaults to mean_agg (arithmetic mean).</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            Single aggregated embedding vector as a list of floats.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">            aget_agg_embedding_from_queries: Async version of this method.</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">            mean_agg: Default aggregation function.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            get_query_embedding: Used internally to embed each query.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">query_embeddings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">agg_fn</span> <span class="o">=</span> <span class="n">agg_fn</span> <span class="ow">or</span> <span class="n">mean_agg</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">return</span> <span class="n">agg_fn</span><span class="p">(</span><span class="n">query_embeddings</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_agg_embedding_from_queries</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">queries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">agg_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an aggregated embedding from multiple queries.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        Async version of get_agg_embedding_from_queries(). Embeds each query</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        asynchronously and then combines them using an aggregation function.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            queries: List of query strings to embed and aggregate.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">            agg_fn: Optional aggregation function that takes a list of embeddings</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">                and returns a single embedding. Defaults to mean_agg.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            Single aggregated embedding vector as a list of floats.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            get_agg_embedding_from_queries: Sync version of this method.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            aget_query_embedding: Used internally to embed each query.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            mean_agg: Default aggregation function.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">query_embeddings</span> <span class="o">=</span> <span class="p">[</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aget_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">agg_fn</span> <span class="o">=</span> <span class="n">agg_fn</span> <span class="ow">or</span> <span class="n">mean_agg</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="k">return</span> <span class="n">agg_fn</span><span class="p">(</span><span class="n">query_embeddings</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed document text synchronously (internal implementation).</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        This is an internal method that subclasses must implement to provide</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        the core text embedding functionality. The public method get_text_embedding()</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        handles caching and calls this method when needed.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">        Text embeddings may use different instructions or prefixes than query</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        embeddings. For example, some models prepend &quot;Represent the document for</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        retrieval: &quot; to optimize for document representation.</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            text: Document text to embed.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            get_text_embedding: Public method that handles caching and delegates</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">                to this method.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">            _aget_text_embedding: Async version of this method.</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            _get_query_embedding: For embedding queries (not documents).</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed document text asynchronously (internal implementation).</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        This is an internal async method that subclasses can override to provide</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        true async text embedding. The default implementation falls back to the</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        sync method _get_text_embedding().</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            text: Document text to embed.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            Subclasses should override this method if they have a native async</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            implementation. Otherwise, the default fallback to the sync method</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            is used.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">            aget_text_embedding: Public async method that handles caching.</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            _get_text_embedding: Sync version used as fallback.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="c1"># Default implementation just falls back on _get_text_embedding</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_text_embeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed multiple texts synchronously in batch (internal implementation).</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">        This internal method provides batch embedding functionality. Subclasses</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        can override this method to provide more efficient batch processing if</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        supported by the underlying model API.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            The default implementation simply loops over _get_text_embedding().</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">            Subclasses should override this if they can process batches more</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">            efficiently.</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            get_text_embedding_batch: Public method for batch embedding with</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">                batching and progress tracking.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">            _aget_text_embeddings: Async version of this method.</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="c1"># Default implementation just loops over _get_text_embedding</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_text_embeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed multiple texts asynchronously in batch (internal implementation).</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        This internal async method provides batch embedding functionality using</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        asyncio.gather for concurrent processing. Subclasses can override this</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        for more efficient batch processing.</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">            List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            The default implementation uses asyncio.gather to process all texts</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            concurrently via _aget_text_embedding(). Subclasses should override</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            this if they can process batches more efficiently.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">            aget_text_embedding_batch: Public async method for batch embedding.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            _get_text_embeddings: Sync version of this method.</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="p">)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_text_embeddings_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve text embeddings from cache or generate if not cached.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        This internal method checks the cache for each text and only generates</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        embeddings for texts not found in the cache. Newly generated embeddings</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        are automatically stored in the cache.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">            List of embedding vectors, one for each input text, preserving order.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">            ValueError: If cache_store is None when this method is called.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            _aget_text_embeddings_cached: Async version of this method.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            get_text_embedding_batch: Public method that uses this for caching.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embeddings_cache must be defined&quot;</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))]</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="c1"># Tuples of (index, text) to be able to keep same order of embeddings</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="n">non_cached_texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="n">cached_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                <span class="n">embeddings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                <span class="n">non_cached_texts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">txt</span><span class="p">))</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_cached_texts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="n">text_embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embeddings</span><span class="p">(</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_cached_texts</span><span class="p">]</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">text_embedding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text_embeddings</span><span class="p">):</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                <span class="n">orig_i</span> <span class="o">=</span> <span class="n">non_cached_texts</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="n">embeddings</span><span class="p">[</span><span class="n">orig_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_embedding</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="n">orig_i</span><span class="p">])</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                <span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="k">return</span> <span class="n">embeddings</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_text_embeddings_cached</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously retrieve text embeddings from cache or generate them.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        Async version of _get_text_embeddings_cached(). Checks the cache for each</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        text and generates embeddings only for texts not found. Newly generated</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        embeddings are automatically stored in the cache.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            List of embedding vectors, one for each input text, preserving order.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            ValueError: If cache_store is None when this method is called.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            _get_text_embeddings_cached: Sync version of this method.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            aget_text_embedding_batch: Public async method that uses this.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embeddings_cache must be defined&quot;</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))]</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="c1"># Tuples of (index, text) to be able to keep same order of embeddings</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">non_cached_texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="n">cached_emb</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aget</span><span class="p">(</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="n">embeddings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="n">non_cached_texts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">txt</span><span class="p">))</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_cached_texts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">text_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embeddings</span><span class="p">(</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">non_cached_texts</span><span class="p">]</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">text_embedding</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text_embeddings</span><span class="p">):</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                <span class="n">orig_i</span> <span class="o">=</span> <span class="n">non_cached_texts</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="n">embeddings</span><span class="p">[</span><span class="n">orig_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_embedding</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="n">orig_i</span><span class="p">])</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aput</span><span class="p">(</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                <span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="k">return</span> <span class="n">embeddings</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate an embedding vector for document text.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        Embeds the input text into a dense vector representation optimized for</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">        document representation tasks. When caching is enabled, checks the cache</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">        first and stores new embeddings automatically.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        Depending on the model, a special instruction may be prepended to the raw</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        text string to optimize for document retrieval. For example, some models</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">        use &quot;Represent the document for retrieval: &quot;.</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            text: Document text to embed.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">            aget_text_embedding: Async version of this method.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">            get_query_embedding: For embedding queries (not documents).</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">            get_text_embedding_batch: For embedding multiple texts efficiently.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">            _get_text_embedding: Internal implementation method.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">cached_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>                <span class="n">text_embedding</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="n">text_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                <span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="k">return</span> <span class="n">text_embedding</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an embedding vector for document text.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">        Async version of get_text_embedding(). Embeds the input text into a dense</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">        vector representation with cache support.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            text: Document text to embed.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            Embedding vector as a list of floats.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">            get_text_embedding: Sync version of this method.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">            aget_query_embedding: For embedding queries asynchronously.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">            aget_text_embedding_batch: For embedding multiple texts efficiently.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">            _aget_text_embedding: Internal async implementation method.</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="n">cached_emb</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aget</span><span class="p">(</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                <span class="n">text_embedding</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                <span class="n">text_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aput</span><span class="p">(</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                    <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                    <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                <span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="k">return</span> <span class="n">text_embedding</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate embeddings for multiple texts with automatic batching.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        Processes a list of texts in batches according to self.batch_size. Supports</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">        optional progress tracking and automatic caching if cache_store is configured.</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">            show_progress: Whether to display a progress bar. Defaults to False.</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">            **kwargs: Additional keyword arguments (reserved for future use).</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">            List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">            aget_text_embedding_batch: Async version with parallel processing.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">            get_text_embedding: For embedding a single text.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">            _get_text_embeddings: Internal batch processing method.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">            _get_text_embeddings_cached: Internal cached batch processing.</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">cur_batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="n">result_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="n">queue_with_progress</span> <span class="o">=</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="n">get_tqdm_iterable</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="s2">&quot;Generating embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="p">)</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">queue_with_progress</span><span class="p">:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="n">cur_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                <span class="c1"># flush</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                    <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embeddings</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                    <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embeddings_cached</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="n">result_embeddings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>                <span class="n">cur_batch</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="k">return</span> <span class="n">result_embeddings</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously generate embeddings for multiple texts with batching.</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">        Async version of get_text_embedding_batch(). Processes texts in batches</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        with concurrent execution for improved performance. Supports worker pooling</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        if num_workers is set.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">            texts: List of document texts to embed.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            show_progress: Whether to display a progress bar. Defaults to False.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">                Requires tqdm package for progress tracking.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">            **kwargs: Additional keyword arguments (reserved for future use).</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">            List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">            When num_workers &gt; 1, uses worker pooling for concurrent batch processing.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            When show_progress=True, attempts to use tqdm.asyncio for progress tracking.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">            get_text_embedding_batch: Sync version of this method.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">            aget_text_embedding: For embedding a single text asynchronously.</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">            _aget_text_embeddings: Internal async batch processing method.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="n">num_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="n">cur_batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="n">embeddings_coroutines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coroutine</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="c1"># for idx, text in queue_with_progress:</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="n">cur_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="c1"># flush</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                    <span class="n">embeddings_coroutines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embeddings</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">))</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                    <span class="n">embeddings_coroutines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embeddings_cached</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                    <span class="p">)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="n">cur_batch</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="c1"># flatten the results of asyncio.gather, which is a list of embeddings lists</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddings_coroutines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>            <span class="k">if</span> <span class="n">num_workers</span> <span class="ow">and</span> <span class="n">num_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_jobs</span><span class="p">(</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                    <span class="n">embeddings_coroutines</span><span class="p">,</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>                    <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>                    <span class="n">workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                    <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                <span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="k">elif</span> <span class="n">show_progress</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>                    <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.asyncio</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm_asyncio</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                    <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">tqdm_asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                        <span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">,</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">embeddings_coroutines</span><span class="p">),</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>                        <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                    <span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>                    <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">)</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>                <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">)</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">result_embeddings</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>            <span class="n">embedding</span> <span class="k">for</span> <span class="n">embeddings</span> <span class="ow">in</span> <span class="n">nested_embeddings</span> <span class="k">for</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="n">embeddings</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="p">]</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="k">return</span> <span class="n">result_embeddings</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">similarity</span><span class="p">(</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="n">embedding1</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="n">embedding2</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">SimilarityMode</span> <span class="o">=</span> <span class="n">SimilarityMode</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate similarity between two embedding vectors.</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">        Static method wrapper for the module-level similarity() function. Provides</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        a convenient way to compute similarity directly from the class.</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            embedding1: First embedding vector (list of floats).</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            embedding2: Second embedding vector (list of floats).</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            mode: Similarity computation mode. Defaults to cosine similarity.</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">            Similarity score as a float. Interpretation depends on the mode.</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            - Computing cosine similarity</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import BaseEmbedding</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">                &gt;&gt;&gt; emb1 = [1.0, 0.0]</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">                &gt;&gt;&gt; emb2 = [1.0, 0.0]</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                &gt;&gt;&gt; float(BaseEmbedding.similarity(emb1, emb2))</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">                1.0</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">                ```</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            - Using different similarity modes</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">                &gt;&gt;&gt; emb1 = [3.0, 4.0]</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">                &gt;&gt;&gt; emb2 = [3.0, 4.0]</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">                &gt;&gt;&gt; float(BaseEmbedding.similarity(emb1, emb2, mode=SimilarityMode.DOT_PRODUCT))</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">                25.0</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">                ```</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            similarity: Module-level function that performs the actual calculation.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            SimilarityMode: Enum defining available similarity modes.</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="k">return</span> <span class="n">similarity</span><span class="p">(</span><span class="n">embedding1</span><span class="o">=</span><span class="n">embedding1</span><span class="p">,</span> <span class="n">embedding2</span><span class="o">=</span><span class="n">embedding2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Embed a sequence of nodes by calling the embedding model.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        This makes the embedding model callable, allowing it to be used as a function.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">        Extracts text content from each node, generates embeddings, and assigns them</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        back to the nodes.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">            nodes: Sequence of BaseNode objects to embed.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">            **kwargs: Additional keyword arguments passed to get_text_embedding_batch.</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">            The input sequence of nodes with embeddings assigned to each node&#39;s</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">            embedding attribute.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">            acall: Async version of this method.</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">            get_text_embedding_batch: Method used internally for batch embedding.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">            MetadataMode.EMBED: Mode used to extract content from nodes.</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">],</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="p">)</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">):</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="n">node</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="k">return</span> <span class="n">nodes</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">acall</span><span class="p">(</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously embed a sequence of nodes.</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        Async version of __call__(). Extracts text content from each node,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        generates embeddings asynchronously, and assigns them back to the nodes.</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            nodes: Sequence of BaseNode objects to embed.</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            **kwargs: Additional keyword arguments passed to aget_text_embedding_batch.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            The input sequence of nodes with embeddings assigned to each node&#39;s</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            embedding attribute.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            __call__: Sync version of this method.</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">            aget_text_embedding_batch: Method used internally for async batch embedding.</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            MetadataMode.EMBED: Mode used to extract content from nodes.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aget_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>            <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">],</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="p">)</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">):</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>            <span class="n">node</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="k">return</span> <span class="n">nodes</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.__call__" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.__call__" class="toclink">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.__call__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Embed a sequence of nodes by calling the embedding model.</p>
<p>This makes the embedding model callable, allowing it to be used as a function.
Extracts text content from each node, generates embeddings, and assigns them
back to the nodes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of BaseNode objects to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to get_text_embedding_batch.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input sequence of nodes with embeddings assigned to each node's</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>embedding attribute.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>acall: Async version of this method.
get_text_embedding_batch: Method used internally for batch embedding.
MetadataMode.EMBED: Mode used to extract content from nodes.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Embed a sequence of nodes by calling the embedding model.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    This makes the embedding model callable, allowing it to be used as a function.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">    Extracts text content from each node, generates embeddings, and assigns them</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">    back to the nodes.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">        nodes: Sequence of BaseNode objects to embed.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">        **kwargs: Additional keyword arguments passed to get_text_embedding_batch.</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        The input sequence of nodes with embeddings assigned to each node&#39;s</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        embedding attribute.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        acall: Async version of this method.</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        get_text_embedding_batch: Method used internally for batch embedding.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        MetadataMode.EMBED: Mode used to extract content from nodes.</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">],</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="p">)</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">):</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="n">node</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>    <span class="k">return</span> <span class="n">nodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.acall" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.acall" class="toclink">
            <code class="highlight language-python"><span class="n">acall</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.acall" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Asynchronously embed a sequence of nodes.</p>
<p>Async version of <strong>call</strong>(). Extracts text content from each node,
generates embeddings asynchronously, and assigns them back to the nodes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of BaseNode objects to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to aget_text_embedding_batch.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input sequence of nodes with embeddings assigned to each node's</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>embedding attribute.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p><strong>call</strong>: Sync version of this method.
aget_text_embedding_batch: Method used internally for async batch embedding.
MetadataMode.EMBED: Mode used to extract content from nodes.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">acall</span><span class="p">(</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Asynchronously embed a sequence of nodes.</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">    Async version of __call__(). Extracts text content from each node,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    generates embeddings asynchronously, and assigns them back to the nodes.</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        nodes: Sequence of BaseNode objects to embed.</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        **kwargs: Additional keyword arguments passed to aget_text_embedding_batch.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        The input sequence of nodes with embeddings assigned to each node&#39;s</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        embedding attribute.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        __call__: Sync version of this method.</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">        aget_text_embedding_batch: Method used internally for async batch embedding.</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">        MetadataMode.EMBED: Mode used to extract content from nodes.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aget_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>        <span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">],</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="p">)</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">):</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="n">node</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>    <span class="k">return</span> <span class="n">nodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.aget_agg_embedding_from_queries" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.aget_agg_embedding_from_queries" class="toclink">
            <code class="highlight language-python"><span class="n">aget_agg_embedding_from_queries</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">agg_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.aget_agg_embedding_from_queries" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Asynchronously generate an aggregated embedding from multiple queries.</p>
<p>Async version of get_agg_embedding_from_queries(). Embeds each query
asynchronously and then combines them using an aggregation function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>queries</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of query strings to embed and aggregate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agg_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional aggregation function that takes a list of embeddings
and returns a single embedding. Defaults to mean_agg.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single aggregated embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>get_agg_embedding_from_queries: Sync version of this method.
aget_query_embedding: Used internally to embed each query.
mean_agg: Default aggregation function.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_agg_embedding_from_queries</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">queries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">agg_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an aggregated embedding from multiple queries.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    Async version of get_agg_embedding_from_queries(). Embeds each query</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">    asynchronously and then combines them using an aggregation function.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        queries: List of query strings to embed and aggregate.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        agg_fn: Optional aggregation function that takes a list of embeddings</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            and returns a single embedding. Defaults to mean_agg.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        Single aggregated embedding vector as a list of floats.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        get_agg_embedding_from_queries: Sync version of this method.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        aget_query_embedding: Used internally to embed each query.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        mean_agg: Default aggregation function.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="n">query_embeddings</span> <span class="o">=</span> <span class="p">[</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aget_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">agg_fn</span> <span class="o">=</span> <span class="n">agg_fn</span> <span class="ow">or</span> <span class="n">mean_agg</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="k">return</span> <span class="n">agg_fn</span><span class="p">(</span><span class="n">query_embeddings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.aget_query_embedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.aget_query_embedding" class="toclink">
            <code class="highlight language-python"><span class="n">aget_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.aget_query_embedding" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Asynchronously generate an embedding vector for a query string.</p>
<p>Async version of get_query_embedding(). Embeds the input query into a dense
vector representation with cache support.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query text to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>get_query_embedding: Sync version of this method.
aget_text_embedding: For embedding document text asynchronously.
_aget_query_embedding: Internal async implementation method.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an embedding vector for a query string.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    Async version of get_query_embedding(). Embeds the input query into a dense</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    vector representation with cache support.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        query: Query text to embed.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Embedding vector as a list of floats.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        get_query_embedding: Sync version of this method.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        aget_text_embedding: For embedding document text asynchronously.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        _aget_query_embedding: Internal async implementation method.</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="n">query_embedding</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="n">cached</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aget</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="n">query_embedding</span> <span class="o">=</span> <span class="n">cached</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="k">if</span> <span class="n">query_embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">query_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aput</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">query_embedding</span><span class="p">},</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">return</span> <span class="n">query_embedding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.aget_text_embedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding" class="toclink">
            <code class="highlight language-python"><span class="n">aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Asynchronously generate an embedding vector for document text.</p>
<p>Async version of get_text_embedding(). Embeds the input text into a dense
vector representation with cache support.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Document text to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>get_text_embedding: Sync version of this method.
aget_query_embedding: For embedding queries asynchronously.
aget_text_embedding_batch: For embedding multiple texts efficiently.
_aget_text_embedding: Internal async implementation method.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Asynchronously generate an embedding vector for document text.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">    Async version of get_text_embedding(). Embeds the input text into a dense</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">    vector representation with cache support.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        text: Document text to embed.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">        Embedding vector as a list of floats.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">        get_text_embedding: Sync version of this method.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">        aget_query_embedding: For embedding queries asynchronously.</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">        aget_text_embedding_batch: For embedding multiple texts efficiently.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">        _aget_text_embedding: Internal async implementation method.</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="n">text_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">cached_emb</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aget</span><span class="p">(</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">aput</span><span class="p">(</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="k">return</span> <span class="n">text_embedding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.aget_text_embedding_batch" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding_batch" class="toclink">
            <code class="highlight language-python"><span class="n">aget_text_embedding_batch</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.aget_text_embedding_batch" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Asynchronously generate embeddings for multiple texts with batching.</p>
<p>Async version of get_text_embedding_batch(). Processes texts in batches
with concurrent execution for improved performance. Supports worker pooling
if num_workers is set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>texts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of document texts to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display a progress bar. Defaults to False.
Requires tqdm package for progress tracking.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (reserved for future use).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of embedding vectors, one for each input text, in the same order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>When num_workers &gt; 1, uses worker pooling for concurrent batch processing.
When show_progress=True, attempts to use tqdm.asyncio for progress tracking.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>get_text_embedding_batch: Sync version of this method.
aget_text_embedding: For embedding a single text asynchronously.
_aget_text_embeddings: Internal async batch processing method.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">aget_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Asynchronously generate embeddings for multiple texts with batching.</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">    Async version of get_text_embedding_batch(). Processes texts in batches</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">    with concurrent execution for improved performance. Supports worker pooling</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">    if num_workers is set.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        texts: List of document texts to embed.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        show_progress: Whether to display a progress bar. Defaults to False.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            Requires tqdm package for progress tracking.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        **kwargs: Additional keyword arguments (reserved for future use).</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        When num_workers &gt; 1, uses worker pooling for concurrent batch processing.</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        When show_progress=True, attempts to use tqdm.asyncio for progress tracking.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        get_text_embedding_batch: Sync version of this method.</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">        aget_text_embedding: For embedding a single text asynchronously.</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">        _aget_text_embeddings: Internal async batch processing method.</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>    <span class="n">num_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="n">cur_batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="n">embeddings_coroutines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Coroutine</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="c1"># for idx, text in queue_with_progress:</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="n">cur_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="c1"># flush</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                <span class="n">embeddings_coroutines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embeddings</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">))</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="n">embeddings_coroutines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_aget_text_embeddings_cached</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                <span class="p">)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>            <span class="n">cur_batch</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="c1"># flatten the results of asyncio.gather, which is a list of embeddings lists</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddings_coroutines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="k">if</span> <span class="n">num_workers</span> <span class="ow">and</span> <span class="n">num_workers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>            <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_jobs</span><span class="p">(</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                <span class="n">embeddings_coroutines</span><span class="p">,</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>                <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>                <span class="n">workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="k">elif</span> <span class="n">show_progress</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>                <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.asyncio</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm_asyncio</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">tqdm_asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                    <span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">,</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                    <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">embeddings_coroutines</span><span class="p">),</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>                    <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                <span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>                <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">)</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">embeddings_coroutines</span><span class="p">)</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="n">nested_embeddings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="n">result_embeddings</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">embedding</span> <span class="k">for</span> <span class="n">embeddings</span> <span class="ow">in</span> <span class="n">nested_embeddings</span> <span class="k">for</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="n">embeddings</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="p">]</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="k">return</span> <span class="n">result_embeddings</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.get_agg_embedding_from_queries" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.get_agg_embedding_from_queries" class="toclink">
            <code class="highlight language-python"><span class="n">get_agg_embedding_from_queries</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">agg_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.get_agg_embedding_from_queries" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Generate a single aggregated embedding from multiple query strings.</p>
<p>Embeds each query individually and then combines them using an aggregation
function. This is useful for creating a unified representation from multiple
related queries or questions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>queries</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of query strings to embed and aggregate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agg_fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional aggregation function that takes a list of embeddings
and returns a single embedding. Defaults to mean_agg (arithmetic mean).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single aggregated embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>aget_agg_embedding_from_queries: Async version of this method.
mean_agg: Default aggregation function.
get_query_embedding: Used internally to embed each query.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_agg_embedding_from_queries</span><span class="p">(</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">queries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">agg_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a single aggregated embedding from multiple query strings.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    Embeds each query individually and then combines them using an aggregation</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    function. This is useful for creating a unified representation from multiple</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">    related queries or questions.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        queries: List of query strings to embed and aggregate.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        agg_fn: Optional aggregation function that takes a list of embeddings</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            and returns a single embedding. Defaults to mean_agg (arithmetic mean).</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        Single aggregated embedding vector as a list of floats.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        aget_agg_embedding_from_queries: Async version of this method.</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        mean_agg: Default aggregation function.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        get_query_embedding: Used internally to embed each query.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">query_embeddings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">agg_fn</span> <span class="o">=</span> <span class="n">agg_fn</span> <span class="ow">or</span> <span class="n">mean_agg</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">return</span> <span class="n">agg_fn</span><span class="p">(</span><span class="n">query_embeddings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.get_query_embedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.get_query_embedding" class="toclink">
            <code class="highlight language-python"><span class="n">get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.get_query_embedding" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Generate an embedding vector for a query string.</p>
<p>Embeds the input query into a dense vector representation optimized for
retrieval tasks. When caching is enabled, checks the cache first and stores
new embeddings automatically.</p>
<p>Depending on the model, a special instruction may be prepended to the raw
query string to optimize for specific tasks. For example, some models use
"Represent the question for retrieving supporting documents: ".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query text to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>aget_query_embedding: Async version of this method.
get_text_embedding: For embedding document text (not queries).
_get_query_embedding: Internal implementation method.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an embedding vector for a query string.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    Embeds the input query into a dense vector representation optimized for</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    retrieval tasks. When caching is enabled, checks the cache first and stores</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    new embeddings automatically.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Depending on the model, a special instruction may be prepended to the raw</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    query string to optimize for specific tasks. For example, some models use</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    &quot;Represent the question for retrieving supporting documents: &quot;.</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        query: Query text to embed.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        Embedding vector as a list of floats.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        aget_query_embedding: Async version of this method.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        get_text_embedding: For embedding document text (not queries).</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        _get_query_embedding: Internal implementation method.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">query_embedding</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="n">query_embedding</span> <span class="o">=</span> <span class="n">cached</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="k">if</span> <span class="n">query_embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">query_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_embedding</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">query_embedding</span><span class="p">},</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="k">return</span> <span class="n">query_embedding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.get_text_embedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding" class="toclink">
            <code class="highlight language-python"><span class="n">get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Generate an embedding vector for document text.</p>
<p>Embeds the input text into a dense vector representation optimized for
document representation tasks. When caching is enabled, checks the cache
first and stores new embeddings automatically.</p>
<p>Depending on the model, a special instruction may be prepended to the raw
text string to optimize for document retrieval. For example, some models
use "Represent the document for retrieval: ".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Document text to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Embedding vector as a list of floats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>aget_text_embedding: Async version of this method.
get_query_embedding: For embedding queries (not documents).
get_text_embedding_batch: For embedding multiple texts efficiently.
_get_text_embedding: Internal implementation method.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an embedding vector for document text.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    Embeds the input text into a dense vector representation optimized for</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    document representation tasks. When caching is enabled, checks the cache</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    first and stores new embeddings automatically.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    Depending on the model, a special instruction may be prepended to the raw</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    text string to optimize for document retrieval. For example, some models</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">    use &quot;Represent the document for retrieval: &quot;.</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        text: Document text to embed.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">        Embedding vector as a list of floats.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        aget_text_embedding: Async version of this method.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">        get_query_embedding: For embedding queries (not documents).</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">        get_text_embedding_batch: For embedding multiple texts efficiently.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        _get_text_embedding: Internal implementation method.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="n">text_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="n">cached_emb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="k">if</span> <span class="n">cached_emb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="n">cached_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">cached_emb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="n">cached_emb</span><span class="p">[</span><span class="n">cached_key</span><span class="p">]</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">text_embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embedding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cache_key</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                <span class="n">key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="n">val</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()):</span> <span class="n">text_embedding</span><span class="p">},</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;embeddings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="k">return</span> <span class="n">text_embedding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.get_text_embedding_batch" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding_batch" class="toclink">
            <code class="highlight language-python"><span class="n">get_text_embedding_batch</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.get_text_embedding_batch" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Generate embeddings for multiple texts with automatic batching.</p>
<p>Processes a list of texts in batches according to self.batch_size. Supports
optional progress tracking and automatic caching if cache_store is configured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>texts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of document texts to embed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display a progress bar. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments (reserved for future use).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of embedding vectors, one for each input text, in the same order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>aget_text_embedding_batch: Async version with parallel processing.
get_text_embedding: For embedding a single text.
_get_text_embeddings: Internal batch processing method.
_get_text_embeddings_cached: Internal cached batch processing.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_text_embedding_batch</span><span class="p">(</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="n">texts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate embeddings for multiple texts with automatic batching.</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    Processes a list of texts in batches according to self.batch_size. Supports</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">    optional progress tracking and automatic caching if cache_store is configured.</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        texts: List of document texts to embed.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        show_progress: Whether to display a progress bar. Defaults to False.</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        **kwargs: Additional keyword arguments (reserved for future use).</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        List of embedding vectors, one for each input text, in the same order.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        aget_text_embedding_batch: Async version with parallel processing.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        get_text_embedding: For embedding a single text.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        _get_text_embeddings: Internal batch processing method.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        _get_text_embeddings_cached: Internal cached batch processing.</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">cur_batch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="n">result_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="n">queue_with_progress</span> <span class="o">=</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="n">get_tqdm_iterable</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="s2">&quot;Generating embeddings&quot;</span><span class="p">)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>    <span class="p">)</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">queue_with_progress</span><span class="p">:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="n">cur_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="c1"># flush</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span><span class="p">:</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embeddings</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_embeddings_cached</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>            <span class="n">result_embeddings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="n">cur_batch</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>    <span class="k">return</span> <span class="n">result_embeddings</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseEmbedding.similarity" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseEmbedding.similarity" class="toclink">
            <code class="highlight language-python"><span class="n">similarity</span><span class="p">(</span><span class="n">embedding1</span><span class="p">,</span> <span class="n">embedding2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">SimilarityMode</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseEmbedding.similarity" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate similarity between two embedding vectors.</p>
<p>Static method wrapper for the module-level similarity() function. Provides
a convenient way to compute similarity directly from the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>embedding1</code>
            </td>
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First embedding vector (list of floats).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>embedding2</code>
            </td>
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second embedding vector (list of floats).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.SimilarityMode">SimilarityMode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similarity computation mode. Defaults to cosine similarity.</p>
              </div>
            </td>
            <td>
                  <code><span title="serapeum.core.base.embeddings.base.SimilarityMode.DEFAULT">DEFAULT</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similarity score as a float. Interpretation depends on the mode.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>
<p>Computing cosine similarity
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEmbedding</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">BaseEmbedding</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">emb1</span><span class="p">,</span> <span class="n">emb2</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="mf">1.0</span>
</code></pre></div></p>
</li>
<li>
<p>Using different similarity modes
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">BaseEmbedding</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="n">emb1</span><span class="p">,</span> <span class="n">emb2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">SimilarityMode</span><span class="o">.</span><span class="n">DOT_PRODUCT</span><span class="p">))</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="mf">25.0</span>
</code></pre></div></p>
</li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>similarity: Module-level function that performs the actual calculation.
SimilarityMode: Enum defining available similarity modes.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="k">def</span><span class="w"> </span><span class="nf">similarity</span><span class="p">(</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="n">embedding1</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="n">embedding2</span><span class="p">:</span> <span class="n">Embedding</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>    <span class="n">mode</span><span class="p">:</span> <span class="n">SimilarityMode</span> <span class="o">=</span> <span class="n">SimilarityMode</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate similarity between two embedding vectors.</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">    Static method wrapper for the module-level similarity() function. Provides</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">    a convenient way to compute similarity directly from the class.</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">        embedding1: First embedding vector (list of floats).</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        embedding2: Second embedding vector (list of floats).</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        mode: Similarity computation mode. Defaults to cosine similarity.</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">        Similarity score as a float. Interpretation depends on the mode.</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        - Computing cosine similarity</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.embeddings import BaseEmbedding</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            &gt;&gt;&gt; emb1 = [1.0, 0.0]</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            &gt;&gt;&gt; emb2 = [1.0, 0.0]</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            &gt;&gt;&gt; float(BaseEmbedding.similarity(emb1, emb2))</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            1.0</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            ```</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        - Using different similarity modes</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            &gt;&gt;&gt; emb1 = [3.0, 4.0]</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            &gt;&gt;&gt; emb2 = [3.0, 4.0]</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            &gt;&gt;&gt; float(BaseEmbedding.similarity(emb1, emb2, mode=SimilarityMode.DOT_PRODUCT))</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            25.0</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            ```</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        similarity: Module-level function that performs the actual calculation.</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        SimilarityMode: Enum defining available similarity modes.</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>    <span class="k">return</span> <span class="n">similarity</span><span class="p">(</span><span class="n">embedding1</span><span class="o">=</span><span class="n">embedding1</span><span class="p">,</span> <span class="n">embedding2</span><span class="o">=</span><span class="n">embedding2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.BaseNode" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode" class="toclink">
            <code>BaseNode</code>


</a><a href="#serapeum.core.embeddings.BaseNode" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="serapeum.core.types.SerializableModel">SerializableModel</span></code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Abstract base class for document nodes with metadata and relationship management.</p>
<p>BaseNode provides the foundational functionality for representing chunks of
documents with rich metadata, embeddings, and hierarchical relationships. It
supports selective metadata inclusion for different contexts (LLM vs embeddings),
automatic change detection via hashing, and efficient relationship caching.</p>
<p>Key features:
- Automatic UUID generation for node identification
- Metadata management with selective inclusion/exclusion for LLM and embedding contexts
- Relationship tracking (source, parent, children, previous, next)
- Embedding storage and retrieval
- Cached LinkedNodes computation with automatic invalidation
- Customizable metadata formatting and serialization</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.id">id</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the node (auto-generated UUID if not provided).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.embedding">embedding</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional vector embedding for the node's content.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flat dictionary of metadata fields used for context and filtering.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.excluded_embed_metadata_keys">excluded_embed_metadata_keys</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata keys excluded from embedding context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.excluded_llm_metadata_keys">excluded_llm_metadata_keys</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata keys excluded from LLM context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.links">links</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Annotated">Annotated</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeType&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeType&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeType">NodeType</a>, <span title="serapeum.core.base.embeddings.types.EnumNameSerializer">EnumNameSerializer</span>], <span title="serapeum.core.base.embeddings.types.NodeInfoType">NodeInfoType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping NodeType to NodeInfo for relationships.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.metadata_template">metadata_template</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Template string for formatting metadata (default: "{key}: {value}").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.BaseNode.metadata_separator">metadata_separator</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Separator between metadata fields (default: newline).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This is an abstract base class. Subclasses must implement:
- get_type(): Return the node's content type identifier
- get_content(): Return the node's content with optional metadata
- set_content(): Update the node's content
- hash: Property returning the content hash for change detection</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Creating a concrete node subclass
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseNode</span><span class="p">,</span> <span class="n">MetadataMode</span><span class="p">,</span> <span class="n">NodeType</span><span class="p">,</span> <span class="n">NodeInfo</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span><span class="w"> </span><span class="nc">TextNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">...</span>     <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Text content of the node&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">...</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">...</span>     <span class="nd">@classmethod</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">...</span>     <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">...</span>         <span class="k">return</span> <span class="s2">&quot;text&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">...</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="o">...</span>     <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="p">:</span> <span class="n">MetadataMode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="o">...</span>         <span class="n">metadata_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_str</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">metadata_mode</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="o">...</span>         <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metadata_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">metadata_str</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="o">...</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="o">...</span>     <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="o">...</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="o">...</span>     <span class="nd">@property</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="o">...</span>     <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="o">...</span>         <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div><ul>
<li>Create a node with metadata
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">...</span>     <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello world&quot;</span><span class="p">,</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">...</span>     <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">}</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="s1">&#39;text&#39;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="s1">&#39;Hello world&#39;</span>
</code></pre></div></li>
</ul>
</li>
<li>Using metadata exclusion for different contexts
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">...</span>     <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sensitive content&quot;</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">...</span>     <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;public&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;internal_id&quot;</span><span class="p">:</span> <span class="s2">&quot;secret123&quot;</span><span class="p">},</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">...</span>     <span class="n">excluded_llm_metadata_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;internal_id&quot;</span><span class="p">]</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div><ul>
<li>For LLM context (excludes internal_id)
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">content_for_llm</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">LLM</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;internal_id&quot;</span> <span class="ow">in</span> <span class="n">content_for_llm</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kc">False</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;public&quot;</span> <span class="ow">in</span> <span class="n">content_for_llm</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kc">True</span>
</code></pre></div></li>
</ul>
</li>
<li>Setting up node relationships
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;parent-doc&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-chunk&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="o">&gt;&gt;&gt;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="o">...</span>     <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Child content&quot;</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="o">...</span>     <span class="n">links</span><span class="o">=</span><span class="p">{</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">:</span> <span class="n">parent</span><span class="p">,</span> <span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="n">parent</span><span class="p">}</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="s1">&#39;parent-doc&#39;</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">source_id</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="s1">&#39;parent-doc&#39;</span>
</code></pre></div></li>
<li>Working with embeddings
    <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sample text&quot;</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">embedding_vec</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">()</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">embedding_vec</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="mi">5</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">embedding_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="mf">0.1</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>NodeInfo: Lightweight reference to a node.
LinkedNodes: Container for node relationships.
MetadataMode: Controls metadata inclusion in different contexts.
SerializableModel: Base class providing serialization capabilities.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseNode</span><span class="p">(</span><span class="n">SerializableModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for document nodes with metadata and relationship management.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    BaseNode provides the foundational functionality for representing chunks of</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">    documents with rich metadata, embeddings, and hierarchical relationships. It</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    supports selective metadata inclusion for different contexts (LLM vs embeddings),</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">    automatic change detection via hashing, and efficient relationship caching.</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">    Key features:</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    - Automatic UUID generation for node identification</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    - Metadata management with selective inclusion/exclusion for LLM and embedding contexts</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    - Relationship tracking (source, parent, children, previous, next)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    - Embedding storage and retrieval</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    - Cached LinkedNodes computation with automatic invalidation</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">    - Customizable metadata formatting and serialization</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        id: Unique identifier for the node (auto-generated UUID if not provided).</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        embedding: Optional vector embedding for the node&#39;s content.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        metadata: Flat dictionary of metadata fields used for context and filtering.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        excluded_embed_metadata_keys: Metadata keys excluded from embedding context.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        excluded_llm_metadata_keys: Metadata keys excluded from LLM context.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">        links: Dictionary mapping NodeType to NodeInfo for relationships.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">        metadata_template: Template string for formatting metadata (default: &quot;{key}: {value}&quot;).</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        metadata_separator: Separator between metadata fields (default: newline).</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        This is an abstract base class. Subclasses must implement:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        - get_type(): Return the node&#39;s content type identifier</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">        - get_content(): Return the node&#39;s content with optional metadata</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        - set_content(): Update the node&#39;s content</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        - hash: Property returning the content hash for change detection</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        - Creating a concrete node subclass</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import BaseNode, MetadataMode, NodeType, NodeInfo</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            ...     text: str = Field(default=&quot;&quot;, description=&quot;Text content of the node&quot;)</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            ...</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            ...     @classmethod</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">            ...         return &quot;text&quot;</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            ...</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            ...     def get_content(self, metadata_mode: MetadataMode = MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            ...         metadata_str = self.get_metadata_str(mode=metadata_mode)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            ...         return f&quot;{metadata_str}\\n{self.text}&quot; if metadata_str else self.text</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            ...</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">            ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">            ...         self.text = value</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">            ...</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">            ...     @property</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">            ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">            ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">            ```</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">            - Create a node with metadata</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">            ...     text=&quot;Hello world&quot;,</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">            ...     metadata={&quot;page&quot;: 1, &quot;author&quot;: &quot;Alice&quot;}</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">            &gt;&gt;&gt; node.get_type()</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">            &#39;text&#39;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">            &gt;&gt;&gt; node.get_content(metadata_mode=MetadataMode.NONE)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">            &#39;Hello world&#39;</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">            ```</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">        - Using metadata exclusion for different contexts</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">            ...     text=&quot;Sensitive content&quot;,</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">            ...     metadata={&quot;public&quot;: &quot;yes&quot;, &quot;internal_id&quot;: &quot;secret123&quot;},</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">            ...     excluded_llm_metadata_keys=[&quot;internal_id&quot;]</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">            ```</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">            - For LLM context (excludes internal_id)</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">            &gt;&gt;&gt; content_for_llm = node.get_content(metadata_mode=MetadataMode.LLM)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">            &gt;&gt;&gt; &quot;internal_id&quot; in content_for_llm</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">            False</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">            &gt;&gt;&gt; &quot;public&quot; in content_for_llm</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">            True</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">            ```</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        - Setting up node relationships</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">            &gt;&gt;&gt; parent = NodeInfo(id=&quot;parent-doc&quot;, type=&quot;document&quot;)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">            &gt;&gt;&gt; child = NodeInfo(id=&quot;child-chunk&quot;, type=&quot;text&quot;)</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">            ...     text=&quot;Child content&quot;,</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">            ...     links={NodeType.PARENT: parent, NodeType.SOURCE: parent}</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">            &gt;&gt;&gt; node.linked_nodes.parent.id</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            &#39;parent-doc&#39;</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">            &gt;&gt;&gt; node.source_id</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">            &#39;parent-doc&#39;</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">            ```</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        - Working with embeddings</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(text=&quot;Sample text&quot;)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">            &gt;&gt;&gt; node.embedding = [0.1, 0.2, 0.3, 0.4, 0.5]</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">            &gt;&gt;&gt; embedding_vec = node.get_embedding()</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">            &gt;&gt;&gt; len(embedding_vec)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">            5</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">            &gt;&gt;&gt; embedding_vec[0]</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">            0.1</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">            ```</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">        NodeInfo: Lightweight reference to a node.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">        LinkedNodes: Container for node relationships.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">        MetadataMode: Controls metadata inclusion in different contexts.</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">        SerializableModel: Base class providing serialization capabilities.</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="c1"># hash is computed on a local field, during the validation process</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">populate_by_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Unique ID of the node.&quot;</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="p">)</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="n">embedding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Embedding of the node.&quot;</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="p">)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A flat dictionary of metadata fields&quot;</span><span class="p">,</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="n">excluded_embed_metadata_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Metadata keys that are excluded from text for the embed model.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="p">)</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="n">excluded_llm_metadata_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Metadata keys that are excluded from text for the LLM.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>    <span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="n">links</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">Annotated</span><span class="p">[</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">EnumNameSerializer</span><span class="p">],</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">NodeInfoType</span><span class="p">,</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A mapping of links to other nodes.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>    <span class="p">)</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="n">metadata_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_METADATA_TMPL</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="s2">&quot;Template for how metadata is formatted, with </span><span class="si">{key}</span><span class="s2"> and &quot;</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="s2">&quot;</span><span class="si">{value}</span><span class="s2"> placeholders.&quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="p">),</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>    <span class="p">)</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>    <span class="n">metadata_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Separator between metadata fields when converting to string.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="n">linked_nodes_cache</span><span class="p">:</span> <span class="n">LinkedNodes</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>        <span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Cached LinkedNodes object, invalidated when links change.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="p">)</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="c1"># Track the links dict id to detect changes</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="n">links_dict_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="n">exclude</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="nb">repr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ID of the links dict to detect when it&#39;s reassigned.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="p">)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_invalidate_linked_nodes_cache_on_links_change</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BaseNode&#39;</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Invalidate the linked_nodes cache when links dict is reassigned.</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        This validator tracks the id of the links dict. When it changes</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        (i.e., links is reassigned), the cache is cleared.</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        Uses Pydantic v2&#39;s @model_validator with object.__setattr__ to avoid recursion.</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="n">current_links_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="c1"># Check if links dict was reassigned (different id)</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_dict_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_dict_id</span> <span class="o">!=</span> <span class="n">current_links_id</span><span class="p">:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>            <span class="c1"># Links changed, clear cache and update tracked id</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;linked_nodes_cache&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;links_dict_id&#39;</span><span class="p">,</span> <span class="n">current_links_id</span><span class="p">)</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get Object type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="p">:</span> <span class="n">MetadataMode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get object content.&quot;&quot;&quot;</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">MetadataMode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Metadata info string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">LLM</span><span class="p">:</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excluded_llm_metadata_keys</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excluded_embed_metadata_keys</span><span class="p">)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">excluded</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>            <span class="k">else</span> <span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">metadata_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filtered</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the content of the node.&quot;&quot;&quot;</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get hash of node.&quot;&quot;&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">source_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">source_id</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_clear_linked_nodes_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Manually clear the linked_nodes cache.</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        Call this method if you mutate the links dict in-place.</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        This is necessary because Pydantic&#39;s field validators only trigger</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">        on field assignment, not on in-place mutations.</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import BaseNode, NodeInfo, NodeType, MetadataMode</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">            &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">            ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">            ...     @classmethod</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">            ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">            ...         return &quot;text&quot;</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">            ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">            ...         return self.text</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">            ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">            ...         self.text = value</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">            ...     @property</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">            ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">            ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(text=&quot;Sample&quot;, links={})</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">            &gt;&gt;&gt; new_source = NodeInfo(id=&quot;updated-source&quot;, type=&quot;document&quot;)</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">            &gt;&gt;&gt; node.links[NodeType.SOURCE] = new_source</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">            &gt;&gt;&gt; node._clear_linked_nodes_cache()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">            &gt;&gt;&gt; node.linked_nodes.source.id</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">            &#39;updated-source&#39;</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">linked_nodes_cache</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">linked_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LinkedNodes</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get linked nodes from the links dictionary.</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        This property validates and converts the links dictionary into a</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        LinkedNodes object. The result is cached and automatically invalidated</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        when the links field is reassigned through Pydantic&#39;s field validation.</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">            LinkedNodes: A validated and cached LinkedNodes object.</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">            - Cache is automatically cleared when `links` is reassigned</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            - For in-place mutations (e.g., node.links[key] = value), you must</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">              either reassign the entire dict OR call _clear_linked_nodes_cache()</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">            - Uses Pydantic&#39;s @field_validator to manage cache invalidation</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import BaseNode, NodeInfo, NodeType, MetadataMode</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">            &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">            &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">            ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            ...     @classmethod</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            ...         return &quot;text&quot;</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">            ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">            ...         return self.text</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            ...         self.text = value</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            ...     @property</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">            ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(text=&quot;Sample&quot;)</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">            &gt;&gt;&gt; source_ref = NodeInfo(id=&quot;doc-123&quot;, type=&quot;document&quot;)</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">            &gt;&gt;&gt; node.links = {NodeType.SOURCE: source_ref}</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">            &gt;&gt;&gt; node.linked_nodes.source.id</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            &#39;doc-123&#39;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(text=&quot;Sample&quot;, links={})</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            &gt;&gt;&gt; prev_ref = NodeInfo(id=&quot;prev-chunk&quot;, type=&quot;text&quot;)</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            &gt;&gt;&gt; node.links[NodeType.PREVIOUS] = prev_ref</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            &gt;&gt;&gt; node._clear_linked_nodes_cache()</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">            &gt;&gt;&gt; node.linked_nodes.previous.id</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">            &#39;prev-chunk&#39;</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            &gt;&gt;&gt; node = TextNode(text=&quot;Sample&quot;)</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            &gt;&gt;&gt; parent = NodeInfo(id=&quot;parent-1&quot;, type=&quot;document&quot;)</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            &gt;&gt;&gt; child1 = NodeInfo(id=&quot;child-1&quot;, type=&quot;text&quot;)</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            &gt;&gt;&gt; child2 = NodeInfo(id=&quot;child-2&quot;, type=&quot;text&quot;)</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            &gt;&gt;&gt; node.links = {NodeType.PARENT: parent, NodeType.CHILD: [child1, child2]}</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            &gt;&gt;&gt; node.linked_nodes.parent.id</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            &#39;parent-1&#39;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            &gt;&gt;&gt; len(node.linked_nodes.children)</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            2</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linked_nodes_cache</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="c1"># Compute and cache the LinkedNodes</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">linked_nodes_cache</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linked_nodes_cache</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">source_text_truncated</span> <span class="o">=</span> <span class="n">truncate_text</span><span class="p">(</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">TRUNCATE_LENGTH</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="n">source_text_wrapped</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>            <span class="sa">f</span><span class="s2">&quot;Text: </span><span class="si">{</span><span class="n">source_text_truncated</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">WRAP_WIDTH</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="p">)</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Node ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">source_text_wrapped</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get embedding.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">            ValueErrors if embedding is None.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embedding not set.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_node_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NodeInfo</span><span class="p">:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get node info.&quot;&quot;&quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="k">return</span> <span class="n">NodeInfo</span><span class="p">(</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>            <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_type</span><span class="p">(),</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="nb">hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="serapeum.core.embeddings.BaseNode.hash" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.hash" class="toclink">
            <code class="highlight language-python"><span class="nb">hash</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseNode.hash" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get hash of node.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="serapeum.core.embeddings.BaseNode.linked_nodes" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.linked_nodes" class="toclink">
            <code class="highlight language-python"><span class="n">linked_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseNode.linked_nodes" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get linked nodes from the links dictionary.</p>
<p>This property validates and converts the links dictionary into a
LinkedNodes object. The result is cached and automatically invalidated
when the links field is reassigned through Pydantic's field validation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>LinkedNodes</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;LinkedNodes&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.LinkedNodes&lt;/code&gt;)" href="#serapeum.core.embeddings.LinkedNodes">LinkedNodes</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A validated and cached LinkedNodes object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Cache is automatically cleared when <code>links</code> is reassigned</li>
<li>For in-place mutations (e.g., node.links[key] = value), you must
  either reassign the entire dict OR call _clear_linked_nodes_cache()</li>
<li>Uses Pydantic's @field_validator to manage cache invalidation</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseNode</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">,</span> <span class="n">NodeType</span><span class="p">,</span> <span class="n">MetadataMode</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TextNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="k">return</span> <span class="s2">&quot;text&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="nd">@property</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">source_ref</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-123&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">{</span><span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="n">source_ref</span><span class="p">}</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">&#39;doc-123&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sample&quot;</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="p">{})</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">prev_ref</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;prev-chunk&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_ref</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">_clear_linked_nodes_cache</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">&#39;prev-chunk&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span> <span class="o">=</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">parent</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;parent-1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">child1</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">child2</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">{</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">:</span> <span class="n">parent</span><span class="p">,</span> <span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">:</span> <span class="p">[</span><span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">]}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">node</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">&#39;parent-1&#39;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">linked_nodes</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">2</span>
</code></pre></div>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.get_content" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.get_content" class="toclink">
            <code class="highlight language-python"><span class="n">get_content</span><span class="p">(</span><span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseNode.get_content" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get object content.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="p">:</span> <span class="n">MetadataMode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get object content.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.get_embedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.get_embedding" class="toclink">
            <code class="highlight language-python"><span class="n">get_embedding</span><span class="p">()</span></code>

</a><a href="#serapeum.core.embeddings.BaseNode.get_embedding" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get embedding.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get embedding.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        ValueErrors if embedding is None.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embedding not set.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.get_metadata_str" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.get_metadata_str" class="toclink">
            <code class="highlight language-python"><span class="n">get_metadata_str</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span></code>

</a><a href="#serapeum.core.embeddings.BaseNode.get_metadata_str" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Metadata info string.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_metadata_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">MetadataMode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Metadata info string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">LLM</span><span class="p">:</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excluded_llm_metadata_keys</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span><span class="p">:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excluded_embed_metadata_keys</span><span class="p">)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="n">filtered</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">excluded</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="k">else</span> <span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filtered</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.get_node_info" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.get_node_info" class="toclink">
            <code class="highlight language-python"><span class="n">get_node_info</span><span class="p">()</span></code>

</a><a href="#serapeum.core.embeddings.BaseNode.get_node_info" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get node info.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_node_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NodeInfo</span><span class="p">:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get node info.&quot;&quot;&quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="k">return</span> <span class="n">NodeInfo</span><span class="p">(</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_type</span><span class="p">(),</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="nb">hash</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.get_type" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.get_type" class="toclink">
            <code class="highlight language-python"><span class="n">get_type</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseNode.get_type" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get Object type.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get Object type.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.BaseNode.set_content" class="doc doc-heading"><a href="#serapeum.core.embeddings.BaseNode.set_content" class="toclink">
            <code class="highlight language-python"><span class="n">set_content</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.BaseNode.set_content" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Set the content of the node.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the content of the node.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.CallMixin" class="doc doc-heading"><a href="#serapeum.core.embeddings.CallMixin" class="toclink">
            <code>CallMixin</code>


</a><a href="#serapeum.core.embeddings.CallMixin" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>Base class for node transformation components.</p>
<p>CallMixin defines the interface for components that transform sequences of nodes,
such as embedders, parsers, or metadata enrichers. It provides both synchronous
and asynchronous calling interfaces.</p>
<p>The mixin uses callable syntax (<code>obj(nodes)</code>) for synchronous transforms and
<code>obj.acall(nodes)</code> for asynchronous transforms, enabling composable pipelines.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.CallMixin.model_config">model_config</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pydantic configuration allowing arbitrary types in subclasses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallMixin</span><span class="p">,</span> <span class="n">BaseNode</span><span class="p">,</span> <span class="n">MetadataMode</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TextNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>        <span class="k">return</span> <span class="s2">&quot;text&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="nd">@property</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">UppercaseTransform</span><span class="p">(</span><span class="n">CallMixin</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span>            <span class="n">node</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">... </span>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transformer</span> <span class="o">=</span> <span class="n">UppercaseTransform</span><span class="p">()</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="p">),</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;world&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">&#39;HELLO&#39;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transformed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">&#39;WORLD&#39;</span>
</code></pre></div>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>BaseEmbedding: Uses CallMixin to enable embedding nodes.
BaseNode: The node type that this mixin transforms.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="k">class</span><span class="w"> </span><span class="nc">CallMixin</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for node transformation components.</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    CallMixin defines the interface for components that transform sequences of nodes,</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    such as embedders, parsers, or metadata enrichers. It provides both synchronous</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    and asynchronous calling interfaces.</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    The mixin uses callable syntax (`obj(nodes)`) for synchronous transforms and</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">    `obj.acall(nodes)` for asynchronous transforms, enabling composable pipelines.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        model_config: Pydantic configuration allowing arbitrary types in subclasses.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        &gt;&gt;&gt; from serapeum.core.base.embeddings.types import CallMixin, BaseNode, MetadataMode</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        &gt;&gt;&gt; from typing import Sequence, Any</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">        ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">        ...     @classmethod</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">        ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        ...         return &quot;text&quot;</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">        ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        ...         return self.text</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        ...         self.text = value</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">        ...     @property</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        &gt;&gt;&gt; class UppercaseTransform(CallMixin):</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        ...     def __call__(self, nodes: Sequence[BaseNode], **kwargs: Any) -&gt; Sequence[BaseNode]:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        ...         result = []</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        ...         for node in nodes:</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        ...             node.set_content(node.get_content().upper())</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">        ...             result.append(node)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        ...         return result</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">        &gt;&gt;&gt; transformer = UppercaseTransform()</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        &gt;&gt;&gt; nodes = [TextNode(text=&quot;hello&quot;), TextNode(text=&quot;world&quot;)]</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">        &gt;&gt;&gt; transformed = transformer(nodes)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">        &gt;&gt;&gt; transformed[0].get_content()</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        &#39;HELLO&#39;</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">        &gt;&gt;&gt; transformed[1].get_content()</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        &#39;WORLD&#39;</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">        BaseEmbedding: Uses CallMixin to enable embedding nodes.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        BaseNode: The node type that this mixin transforms.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform a sequence of nodes synchronously.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        Subclasses must implement this method to define their transformation logic.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        This method is called when the object is invoked directly: `obj(nodes)`.</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            nodes: Sequence of BaseNode instances to transform.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">            **kwargs: Additional keyword arguments specific to the transformation.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            Transformed sequence of BaseNode instances.</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import CallMixin, BaseNode, MetadataMode</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">            &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">            &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            ...     @classmethod</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">            ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            ...         return &quot;text&quot;</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            ...         return self.text</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">            ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">            ...         self.text = value</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">            ...     @property</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">            ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">            ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">            &gt;&gt;&gt; class MetadataAdder(CallMixin):</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">            ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">            ...         result = []</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">            ...         for i, node in enumerate(nodes):</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            ...             node.metadata[&quot;index&quot;] = i</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">            ...             result.append(node)</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            ...         return result</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">            &gt;&gt;&gt; adder = MetadataAdder()</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">            &gt;&gt;&gt; nodes = [TextNode(text=&quot;first&quot;), TextNode(text=&quot;second&quot;)]</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            &gt;&gt;&gt; processed = adder(nodes)</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            &gt;&gt;&gt; processed[0].metadata[&quot;index&quot;]</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">            0</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">            &gt;&gt;&gt; processed[1].metadata[&quot;index&quot;]</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">            1</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            Implementations should preserve node identity where possible and</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            avoid mutating input nodes unless explicitly documented.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">acall</span><span class="p">(</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform a sequence of nodes asynchronously.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        Default implementation delegates to synchronous `__call__`. Subclasses</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        can override this for true async implementations (e.g., async API calls).</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            nodes: Sequence of BaseNode instances to transform.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            **kwargs: Additional keyword arguments specific to the transformation.</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">            Transformed sequence of BaseNode instances.</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">            &gt;&gt;&gt; import asyncio</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import CallMixin, BaseNode, MetadataMode</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">            &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">            &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">            ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">            ...     @classmethod</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">            ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            ...         return &quot;text&quot;</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">            ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">            ...         return self.text</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">            ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            ...         self.text = value</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">            ...     @property</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">            ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">            ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            &gt;&gt;&gt; class AsyncTransform(CallMixin):</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">            ...         return nodes</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            ...     async def acall(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            ...         await asyncio.sleep(0)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            ...         for node in nodes:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            ...             node.metadata[&quot;async_processed&quot;] = True</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            ...         return nodes</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            &gt;&gt;&gt; transform = AsyncTransform()</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            &gt;&gt;&gt; nodes = [TextNode(text=&quot;test&quot;)]</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            &gt;&gt;&gt; result = asyncio.run(transform.acall(nodes))</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            &gt;&gt;&gt; result[0].metadata[&quot;async_processed&quot;]</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">            True</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            &gt;&gt;&gt; class SyncOnlyTransform(CallMixin):</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">            ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            ...         for node in nodes:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">            ...             node.metadata[&quot;processed&quot;] = True</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            ...         return nodes</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">            &gt;&gt;&gt; sync_transform = SyncOnlyTransform()</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">            &gt;&gt;&gt; nodes = [TextNode(text=&quot;test&quot;)]</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            &gt;&gt;&gt; result = asyncio.run(sync_transform.acall(nodes))</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">            &gt;&gt;&gt; result[0].metadata[&quot;processed&quot;]</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            True</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">            If no true async implementation is needed, the default delegation</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            to `__call__` is sufficient. Override only if the transformation</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            benefits from async/await (e.g., I/O operations).</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.CallMixin.__call__" class="doc doc-heading"><a href="#serapeum.core.embeddings.CallMixin.__call__" class="toclink">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.CallMixin.__call__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Transform a sequence of nodes synchronously.</p>
<p>Subclasses must implement this method to define their transformation logic.
This method is called when the object is invoked directly: <code>obj(nodes)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of BaseNode instances to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments specific to the transformation.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformed sequence of BaseNode instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallMixin</span><span class="p">,</span> <span class="n">BaseNode</span><span class="p">,</span> <span class="n">MetadataMode</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TextNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="k">return</span> <span class="s2">&quot;text&quot;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="nd">@property</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MetadataAdder</span><span class="p">(</span><span class="n">CallMixin</span><span class="p">):</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>            <span class="n">node</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">adder</span> <span class="o">=</span> <span class="n">MetadataAdder</span><span class="p">()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">),</span> <span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;second&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">processed</span> <span class="o">=</span> <span class="n">adder</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">processed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">0</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">processed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">1</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Implementations should preserve node identity where possible and
avoid mutating input nodes unless explicitly documented.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a sequence of nodes synchronously.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    Subclasses must implement this method to define their transformation logic.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">    This method is called when the object is invoked directly: `obj(nodes)`.</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        nodes: Sequence of BaseNode instances to transform.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        **kwargs: Additional keyword arguments specific to the transformation.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">        Transformed sequence of BaseNode instances.</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        &gt;&gt;&gt; from serapeum.core.base.embeddings.types import CallMixin, BaseNode, MetadataMode</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">        &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">        ...     @classmethod</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        ...         return &quot;text&quot;</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        ...         return self.text</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        ...         self.text = value</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        ...     @property</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        &gt;&gt;&gt; class MetadataAdder(CallMixin):</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        ...         result = []</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        ...         for i, node in enumerate(nodes):</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        ...             node.metadata[&quot;index&quot;] = i</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        ...             result.append(node)</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">        ...         return result</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">        &gt;&gt;&gt; adder = MetadataAdder()</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">        &gt;&gt;&gt; nodes = [TextNode(text=&quot;first&quot;), TextNode(text=&quot;second&quot;)]</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">        &gt;&gt;&gt; processed = adder(nodes)</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">        &gt;&gt;&gt; processed[0].metadata[&quot;index&quot;]</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">        0</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">        &gt;&gt;&gt; processed[1].metadata[&quot;index&quot;]</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        1</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        Implementations should preserve node identity where possible and</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        avoid mutating input nodes unless explicitly documented.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.CallMixin.acall" class="doc doc-heading"><a href="#serapeum.core.embeddings.CallMixin.acall" class="toclink">
            <code class="highlight language-python"><span class="n">acall</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.CallMixin.acall" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Transform a sequence of nodes asynchronously.</p>
<p>Default implementation delegates to synchronous <code>__call__</code>. Subclasses
can override this for true async implementations (e.g., async API calls).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of BaseNode instances to transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments specific to the transformation.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;BaseNode&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.BaseNode&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseNode">BaseNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformed sequence of BaseNode instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">CallMixin</span><span class="p">,</span> <span class="n">BaseNode</span><span class="p">,</span> <span class="n">MetadataMode</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TextNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>        <span class="k">return</span> <span class="s2">&quot;text&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_mode</span><span class="o">=</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="nd">@property</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">AsyncTransform</span><span class="p">(</span><span class="n">CallMixin</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">nodes</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">acall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span>        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">... </span>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">... </span>            <span class="n">node</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;async_processed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">nodes</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">AsyncTransform</span><span class="p">()</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">acall</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;async_processed&quot;</span><span class="p">]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">True</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">SyncOnlyTransform</span><span class="p">(</span><span class="n">CallMixin</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>            <span class="n">node</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;processed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">nodes</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">sync_transform</span> <span class="o">=</span> <span class="n">SyncOnlyTransform</span><span class="p">()</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">TextNode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sync_transform</span><span class="o">.</span><span class="n">acall</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;processed&quot;</span><span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">True</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>If no true async implementation is needed, the default delegation
to <code>__call__</code> is sufficient. Override only if the transformation
benefits from async/await (e.g., I/O operations).</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">acall</span><span class="p">(</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BaseNode</span><span class="p">]:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transform a sequence of nodes asynchronously.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    Default implementation delegates to synchronous `__call__`. Subclasses</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">    can override this for true async implementations (e.g., async API calls).</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        nodes: Sequence of BaseNode instances to transform.</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        **kwargs: Additional keyword arguments specific to the transformation.</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">        Transformed sequence of BaseNode instances.</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        &gt;&gt;&gt; import asyncio</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        &gt;&gt;&gt; from serapeum.core.base.embeddings.types import CallMixin, BaseNode, MetadataMode</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">        &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">        &gt;&gt;&gt; from pydantic import Field</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        &gt;&gt;&gt; class TextNode(BaseNode):</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        ...     text: str = Field(default=&quot;&quot;)</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        ...     @classmethod</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        ...     def get_type(cls) -&gt; str:</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        ...         return &quot;text&quot;</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">        ...     def get_content(self, metadata_mode=MetadataMode.ALL) -&gt; str:</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        ...         return self.text</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        ...     def set_content(self, value: str) -&gt; None:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">        ...         self.text = value</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">        ...     @property</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        ...     def hash(self) -&gt; str:</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">        ...         return hashlib.sha256(self.text.encode()).hexdigest()</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        &gt;&gt;&gt; class AsyncTransform(CallMixin):</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">        ...         return nodes</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        ...     async def acall(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">        ...         await asyncio.sleep(0)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        ...         for node in nodes:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        ...             node.metadata[&quot;async_processed&quot;] = True</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        ...         return nodes</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        &gt;&gt;&gt; transform = AsyncTransform()</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        &gt;&gt;&gt; nodes = [TextNode(text=&quot;test&quot;)]</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">        &gt;&gt;&gt; result = asyncio.run(transform.acall(nodes))</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">        &gt;&gt;&gt; result[0].metadata[&quot;async_processed&quot;]</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">        True</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        &gt;&gt;&gt; class SyncOnlyTransform(CallMixin):</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        ...     def __call__(self, nodes, **kwargs):</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">        ...         for node in nodes:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">        ...             node.metadata[&quot;processed&quot;] = True</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        ...         return nodes</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">        &gt;&gt;&gt; sync_transform = SyncOnlyTransform()</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        &gt;&gt;&gt; nodes = [TextNode(text=&quot;test&quot;)]</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        &gt;&gt;&gt; result = asyncio.run(sync_transform.acall(nodes))</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        &gt;&gt;&gt; result[0].metadata[&quot;processed&quot;]</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        True</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        If no true async implementation is needed, the default delegation</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        to `__call__` is sufficient. Override only if the transformation</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">        benefits from async/await (e.g., I/O operations).</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.LinkedNodes" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes" class="toclink">
            <code>LinkedNodes</code>


</a><a href="#serapeum.core.embeddings.LinkedNodes" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="serapeum.core.types.SerializableModel">SerializableModel</span></code></p>



        <p>Immutable container for node relationships in a document hierarchy.</p>
<p>LinkedNodes manages references between nodes in a document structure, supporting
linear sequences (previous/next), hierarchical relationships (parent/children),
and source document tracking. The model is frozen to prevent accidental mutation
of relationship structures.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.LinkedNodes.source">source</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference to the original source document node.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.LinkedNodes.previous">previous</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference to the previous node in a sequence.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.LinkedNodes.next">next</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference to the next node in a sequence.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.LinkedNodes.parent">parent</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference to the parent node in a hierarchy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.LinkedNodes.children">children</span></code></td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of child node references in a hierarchy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Creating a linear sequence of nodes
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">,</span> <span class="n">NodeType</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">prev_node</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;chunk-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">next_node</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;chunk-3&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">previous</span><span class="o">=</span><span class="n">prev_node</span><span class="p">,</span> <span class="nb">next</span><span class="o">=</span><span class="n">next_node</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="s1">&#39;chunk-1&#39;</span>
</code></pre></div></li>
<li>Building hierarchical relationships
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;section-1&quot;</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">child1</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;para-1&quot;</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">child2</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;para-2&quot;</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">])</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="mi">2</span>
</code></pre></div></li>
<li>Using factory method with NodeType enum
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">NodeType</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-main&quot;</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="n">source</span><span class="p">}</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">links_dict</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="s1">&#39;doc-main&#39;</span>
</code></pre></div></li>
<li>Accessing source ID property
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;original-doc&quot;</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source_id</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="s1">&#39;original-doc&#39;</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>NodeType: Enum defining relationship types.
NodeInfo: References stored in relationship fields.
BaseNode.linked_nodes: Property that creates LinkedNodes from links dict.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">class</span><span class="w"> </span><span class="nc">LinkedNodes</span><span class="p">(</span><span class="n">SerializableModel</span><span class="p">):</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Immutable container for node relationships in a document hierarchy.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    LinkedNodes manages references between nodes in a document structure, supporting</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    linear sequences (previous/next), hierarchical relationships (parent/children),</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    and source document tracking. The model is frozen to prevent accidental mutation</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    of relationship structures.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        source: Reference to the original source document node.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        previous: Reference to the previous node in a sequence.</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        next: Reference to the next node in a sequence.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        parent: Reference to the parent node in a hierarchy.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        children: List of child node references in a hierarchy.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        - Creating a linear sequence of nodes</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo, NodeType</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            &gt;&gt;&gt; prev_node = NodeInfo(id=&quot;chunk-1&quot;)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            &gt;&gt;&gt; next_node = NodeInfo(id=&quot;chunk-3&quot;)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(previous=prev_node, next=next_node)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            &gt;&gt;&gt; links.previous.id</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            &#39;chunk-1&#39;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            ```</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        - Building hierarchical relationships</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            &gt;&gt;&gt; parent = NodeInfo(id=&quot;section-1&quot;)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            &gt;&gt;&gt; child1 = NodeInfo(id=&quot;para-1&quot;)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            &gt;&gt;&gt; child2 = NodeInfo(id=&quot;para-2&quot;)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(parent=parent, children=[child1, child2])</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            &gt;&gt;&gt; len(links.children)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            2</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            ```</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        - Using factory method with NodeType enum</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import NodeType</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            &gt;&gt;&gt; source = NodeInfo(id=&quot;doc-main&quot;)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            &gt;&gt;&gt; links_dict = {NodeType.SOURCE: source}</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes.create(links_dict)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            &gt;&gt;&gt; links.source.id</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            &#39;doc-main&#39;</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            ```</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        - Accessing source ID property</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            &gt;&gt;&gt; source = NodeInfo(id=&quot;original-doc&quot;)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(source=source)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            &gt;&gt;&gt; links.source_id</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            &#39;original-doc&#39;</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            ```</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        NodeType: Enum defining relationship types.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        NodeInfo: References stored in relationship fields.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        BaseNode.linked_nodes: Property that creates LinkedNodes from links dict.</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">previous</span><span class="p">:</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="nb">next</span><span class="p">:</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">parent</span><span class="p">:</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NodeInfo</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;previous&#39;</span><span class="p">,</span> <span class="s1">&#39;next&#39;</span><span class="p">,</span> <span class="s1">&#39;parent&#39;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_single_node</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate that single-node fields contain NodeInfo objects.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        Ensures that source, previous, next, and parent fields contain exactly</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        one NodeInfo instance (not a list). Called automatically by Pydantic</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        during model instantiation and validation.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            v: Value to validate, expected to be NodeInfo or None.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            The validated NodeInfo instance or None.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            ValueError: If v is not None and not a NodeInfo instance.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            - Valid single node assignment</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">                &gt;&gt;&gt; node = NodeInfo(id=&quot;valid&quot;)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(source=node)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">                &gt;&gt;&gt; links.source.id</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">                &#39;valid&#39;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">                ```</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            - Invalid list assignment to single-node field</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">                &gt;&gt;&gt; LinkedNodes(source=[NodeInfo(id=&quot;bad&quot;)])  # doctest: +SKIP</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">                Traceback (most recent call last):</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">                    ...</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">                ValueError: Must be a NodeInfo object, not a list</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">                ```</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            This validator applies to: source, previous, next, parent fields.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            The children field has a separate validator for list validation.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">):</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must be a NodeInfo object, not a list&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">return</span> <span class="n">v</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_children_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NodeInfo</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate that children field contains a list of NodeInfo objects.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        Ensures the children field is a list (not a single NodeInfo instance).</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        Called automatically by Pydantic during model instantiation and validation.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            v: Value to validate, expected to be list[NodeInfo] or None.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            The validated list of NodeInfo instances or None.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            ValueError: If v is not None and not a list.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            - Valid children list</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">                &gt;&gt;&gt; child1 = NodeInfo(id=&quot;child-1&quot;)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">                &gt;&gt;&gt; child2 = NodeInfo(id=&quot;child-2&quot;)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(children=[child1, child2])</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">                &gt;&gt;&gt; len(links.children)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                2</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">                ```</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            - Invalid single NodeInfo for children</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">                &gt;&gt;&gt; LinkedNodes(children=NodeInfo(id=&quot;bad&quot;))  # doctest: +SKIP</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">                Traceback (most recent call last):</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">                    ...</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">                ValueError: Children must be a list of NodeInfo objects</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">                ```</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            - Empty children list is valid</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(children=[])</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">                &gt;&gt;&gt; links.children</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">                []</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">                ```</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">            This validator is specific to the children field, which represents</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            one-to-many relationships.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Children must be a list of NodeInfo objects&quot;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">return</span> <span class="n">v</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="bp">cls</span><span class="p">,</span> <span class="n">linked_nodes_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">NodeInfoType</span><span class="p">]</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LinkedNodes&quot;</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create LinkedNodes from a dict mapping NodeType to NodeInfo/list.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        Factory method that converts a dictionary with NodeType keys into a</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        validated LinkedNodes instance. Pydantic validators automatically check</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        that single-node fields contain NodeInfo and children contains a list.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            linked_nodes_info: Dictionary mapping NodeType enum values to either</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">                NodeInfo (for single relationships) or list[NodeInfo] (for</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">                children). Missing keys are treated as None.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            A new LinkedNodes instance with validated relationships.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            ValueError: If a single-node field (SOURCE, PREVIOUS, NEXT, PARENT)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">                receives a list, or if children receives a non-list value.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">            - Creating from a dict with mixed relationships</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo, NodeType</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">                &gt;&gt;&gt; source = NodeInfo(id=&quot;doc-1&quot;)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">                &gt;&gt;&gt; parent = NodeInfo(id=&quot;section-1&quot;)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">                &gt;&gt;&gt; children = [NodeInfo(id=&quot;para-1&quot;), NodeInfo(id=&quot;para-2&quot;)]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">                &gt;&gt;&gt; links_dict = {</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">                ...     NodeType.SOURCE: source,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">                ...     NodeType.PARENT: parent,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">                ...     NodeType.CHILD: children</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">                ... }</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes.create(links_dict)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">                &gt;&gt;&gt; links.source.id</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">                &#39;doc-1&#39;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">                ```</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            - Creating with only some relationships</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">                &gt;&gt;&gt; prev = NodeInfo(id=&quot;chunk-1&quot;)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">                &gt;&gt;&gt; next_node = NodeInfo(id=&quot;chunk-3&quot;)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes.create({</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">                ...     NodeType.PREVIOUS: prev,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">                ...     NodeType.NEXT: next_node</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">                ... })</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">                &gt;&gt;&gt; links.previous.id</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">                &#39;chunk-1&#39;</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">                ```</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            - Empty dict creates all-None instance</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes.create({})</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">                &gt;&gt;&gt; links.source is None</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">                True</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">                ```</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            LinkedNodes.as_dict: Inverse operation converting LinkedNodes to dict.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">            NodeType: Enum defining valid relationship types.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">source</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">),</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">previous</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">),</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="nb">next</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">NEXT</span><span class="p">),</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">parent</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">),</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">children</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">),</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">NodeInfoType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert LinkedNodes to a dictionary mapping NodeType to NodeInfo.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        Creates a dictionary representation with NodeType enum keys and NodeInfo</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        values. None values are excluded from the result to create a compact</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        representation containing only active relationships.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            Dictionary with NodeType keys and NodeInfo/list[NodeInfo] values.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            Only non-None relationships are included.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            - Converting to dict with multiple relationships</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo, NodeType</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">                &gt;&gt;&gt; source = NodeInfo(id=&quot;doc-1&quot;)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">                &gt;&gt;&gt; parent = NodeInfo(id=&quot;section-1&quot;)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(source=source, parent=parent)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">                &gt;&gt;&gt; result = links.as_dict()</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">                &gt;&gt;&gt; result[NodeType.SOURCE].id</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">                &#39;doc-1&#39;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">                ```</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            - None values are excluded</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(source=NodeInfo(id=&quot;doc-1&quot;))</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">                &gt;&gt;&gt; result = links.as_dict()</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">                &gt;&gt;&gt; NodeType.PREVIOUS in result</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">                False</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">                ```</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            - Round-trip with create method</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">                &gt;&gt;&gt; original = LinkedNodes(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">                ...     source=NodeInfo(id=&quot;src&quot;),</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">                ...     children=[NodeInfo(id=&quot;child-1&quot;)]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">                &gt;&gt;&gt; as_dict = original.as_dict()</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">                &gt;&gt;&gt; restored = LinkedNodes.create(as_dict)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">                &gt;&gt;&gt; restored.source.id</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">                &#39;src&#39;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">                ```</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            LinkedNodes.create: Factory method for creating from dict.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">            BaseNode.links: Uses this format for storing relationships.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">linked_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">NodeType</span><span class="o">.</span><span class="n">NEXT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="p">}</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">linked_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">linked_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="p">}</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="k">return</span> <span class="n">linked_nodes</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">source_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the ID of the source node if it exists.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        Convenience property for accessing the source node&#39;s ID without</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        checking if source is None first.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            The source node&#39;s ID string, or None if no source is set.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            - Accessing source ID when source exists</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">                &gt;&gt;&gt; source = NodeInfo(id=&quot;document-123&quot;)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes(source=source)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">                &gt;&gt;&gt; links.source_id</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">                &#39;document-123&#39;</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">                ```</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            - Accessing when source is None</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">                &gt;&gt;&gt; links = LinkedNodes()</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">                &gt;&gt;&gt; links.source_id is None</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">                True</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">                ```</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">            BaseNode.source_id: Uses this property for node source tracking.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">source_id</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="n">source_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">return</span> <span class="n">source_id</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="serapeum.core.embeddings.LinkedNodes.source_id" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes.source_id" class="toclink">
            <code class="highlight language-python"><span class="n">source_id</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.LinkedNodes.source_id" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the ID of the source node if it exists.</p>
<p>Convenience property for accessing the source node's ID without
checking if source is None first.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source node's ID string, or None if no source is set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Accessing source ID when source exists
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;document-123&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source_id</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="s1">&#39;document-123&#39;</span>
</code></pre></div></li>
<li>Accessing when source is None
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">()</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source_id</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kc">True</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>BaseNode.source_id: Uses this property for node source tracking.</p>
</details>
    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.LinkedNodes.as_dict" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes.as_dict" class="toclink">
            <code class="highlight language-python"><span class="n">as_dict</span><span class="p">()</span></code>

</a><a href="#serapeum.core.embeddings.LinkedNodes.as_dict" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Convert LinkedNodes to a dictionary mapping NodeType to NodeInfo.</p>
<p>Creates a dictionary representation with NodeType enum keys and NodeInfo
values. None values are excluded from the result to create a compact
representation containing only active relationships.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeType&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeType&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeType">NodeType</a>, <span title="serapeum.core.base.embeddings.types.NodeInfoType">NodeInfoType</span> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with NodeType keys and NodeInfo/list[NodeInfo] values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeType&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeType&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeType">NodeType</a>, <span title="serapeum.core.base.embeddings.types.NodeInfoType">NodeInfoType</span> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Only non-None relationships are included.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Converting to dict with multiple relationships
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">,</span> <span class="n">NodeType</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;section-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span><span class="p">[</span><span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="s1">&#39;doc-1&#39;</span>
</code></pre></div></li>
<li>None values are excluded
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-1&quot;</span><span class="p">))</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span> <span class="ow">in</span> <span class="n">result</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kc">False</span>
</code></pre></div></li>
<li>Round-trip with create method
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">original</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">...</span>     <span class="n">source</span><span class="o">=</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;src&quot;</span><span class="p">),</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">...</span>     <span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-1&quot;</span><span class="p">)]</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">as_dict</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">restored</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">as_dict</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">restored</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="s1">&#39;src&#39;</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>LinkedNodes.create: Factory method for creating from dict.
BaseNode.links: Uses this format for storing relationships.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">NodeInfoType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert LinkedNodes to a dictionary mapping NodeType to NodeInfo.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">    Creates a dictionary representation with NodeType enum keys and NodeInfo</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    values. None values are excluded from the result to create a compact</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    representation containing only active relationships.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Dictionary with NodeType keys and NodeInfo/list[NodeInfo] values.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        Only non-None relationships are included.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        - Converting to dict with multiple relationships</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo, NodeType</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            &gt;&gt;&gt; source = NodeInfo(id=&quot;doc-1&quot;)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            &gt;&gt;&gt; parent = NodeInfo(id=&quot;section-1&quot;)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(source=source, parent=parent)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            &gt;&gt;&gt; result = links.as_dict()</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            &gt;&gt;&gt; result[NodeType.SOURCE].id</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">            &#39;doc-1&#39;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            ```</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        - None values are excluded</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(source=NodeInfo(id=&quot;doc-1&quot;))</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            &gt;&gt;&gt; result = links.as_dict()</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            &gt;&gt;&gt; NodeType.PREVIOUS in result</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            False</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">            ```</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        - Round-trip with create method</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            &gt;&gt;&gt; original = LinkedNodes(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">            ...     source=NodeInfo(id=&quot;src&quot;),</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            ...     children=[NodeInfo(id=&quot;child-1&quot;)]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            &gt;&gt;&gt; as_dict = original.as_dict()</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">            &gt;&gt;&gt; restored = LinkedNodes.create(as_dict)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            &gt;&gt;&gt; restored.source.id</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            &#39;src&#39;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">            ```</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        LinkedNodes.create: Factory method for creating from dict.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        BaseNode.links: Uses this format for storing relationships.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="n">linked_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">previous</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">NodeType</span><span class="o">.</span><span class="n">NEXT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="p">}</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">linked_nodes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">linked_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="p">}</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">return</span> <span class="n">linked_nodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.LinkedNodes.create" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes.create" class="toclink">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">linked_nodes_info</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.LinkedNodes.create" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create LinkedNodes from a dict mapping NodeType to NodeInfo/list.</p>
<p>Factory method that converts a dictionary with NodeType keys into a
validated LinkedNodes instance. Pydantic validators automatically check
that single-node fields contain NodeInfo and children contains a list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>linked_nodes_info</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeType&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeType&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeType">NodeType</a>, <span title="serapeum.core.base.embeddings.types.NodeInfoType">NodeInfoType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping NodeType enum values to either
NodeInfo (for single relationships) or list[NodeInfo] (for
children). Missing keys are treated as None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>&#39;LinkedNodes&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new LinkedNodes instance with validated relationships.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a single-node field (SOURCE, PREVIOUS, NEXT, PARENT)
receives a list, or if children receives a non-list value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Creating from a dict with mixed relationships
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">,</span> <span class="n">NodeType</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;section-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;para-1&quot;</span><span class="p">),</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;para-2&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">...</span>     <span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">...</span>     <span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">:</span> <span class="n">parent</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">...</span>     <span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">:</span> <span class="n">children</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">...</span> <span class="p">}</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">links_dict</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="s1">&#39;doc-1&#39;</span>
</code></pre></div></li>
<li>Creating with only some relationships
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">prev</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;chunk-1&quot;</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">next_node</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;chunk-3&quot;</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">({</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">...</span>     <span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">:</span> <span class="n">prev</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">...</span>     <span class="n">NodeType</span><span class="o">.</span><span class="n">NEXT</span><span class="p">:</span> <span class="n">next_node</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">...</span> <span class="p">})</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">previous</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="s1">&#39;chunk-1&#39;</span>
</code></pre></div></li>
<li>Empty dict creates all-None instance
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="o">.</span><span class="n">create</span><span class="p">({})</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kc">True</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>LinkedNodes.as_dict: Inverse operation converting LinkedNodes to dict.
NodeType: Enum defining valid relationship types.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="bp">cls</span><span class="p">,</span> <span class="n">linked_nodes_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">NodeType</span><span class="p">,</span> <span class="n">NodeInfoType</span><span class="p">]</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LinkedNodes&quot;</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create LinkedNodes from a dict mapping NodeType to NodeInfo/list.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    Factory method that converts a dictionary with NodeType keys into a</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    validated LinkedNodes instance. Pydantic validators automatically check</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    that single-node fields contain NodeInfo and children contains a list.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        linked_nodes_info: Dictionary mapping NodeType enum values to either</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">            NodeInfo (for single relationships) or list[NodeInfo] (for</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">            children). Missing keys are treated as None.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        A new LinkedNodes instance with validated relationships.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        ValueError: If a single-node field (SOURCE, PREVIOUS, NEXT, PARENT)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            receives a list, or if children receives a non-list value.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        - Creating from a dict with mixed relationships</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo, NodeType</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            &gt;&gt;&gt; source = NodeInfo(id=&quot;doc-1&quot;)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            &gt;&gt;&gt; parent = NodeInfo(id=&quot;section-1&quot;)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            &gt;&gt;&gt; children = [NodeInfo(id=&quot;para-1&quot;), NodeInfo(id=&quot;para-2&quot;)]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">            &gt;&gt;&gt; links_dict = {</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">            ...     NodeType.SOURCE: source,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            ...     NodeType.PARENT: parent,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">            ...     NodeType.CHILD: children</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            ... }</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes.create(links_dict)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">            &gt;&gt;&gt; links.source.id</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            &#39;doc-1&#39;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            ```</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        - Creating with only some relationships</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            &gt;&gt;&gt; prev = NodeInfo(id=&quot;chunk-1&quot;)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            &gt;&gt;&gt; next_node = NodeInfo(id=&quot;chunk-3&quot;)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes.create({</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            ...     NodeType.PREVIOUS: prev,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            ...     NodeType.NEXT: next_node</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">            ... })</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            &gt;&gt;&gt; links.previous.id</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            &#39;chunk-1&#39;</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">            ```</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        - Empty dict creates all-None instance</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes.create({})</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">            &gt;&gt;&gt; links.source is None</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            True</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">            ```</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        LinkedNodes.as_dict: Inverse operation converting LinkedNodes to dict.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        NodeType: Enum defining valid relationship types.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">source</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">SOURCE</span><span class="p">),</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">previous</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PREVIOUS</span><span class="p">),</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="nb">next</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">NEXT</span><span class="p">),</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">parent</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">PARENT</span><span class="p">),</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">children</span><span class="o">=</span><span class="n">linked_nodes_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NodeType</span><span class="o">.</span><span class="n">CHILD</span><span class="p">),</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.LinkedNodes.validate_children_list" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes.validate_children_list" class="toclink">
            <code class="highlight language-python"><span class="n">validate_children_list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.LinkedNodes.validate_children_list" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Validate that children field contains a list of NodeInfo objects.</p>
<p>Ensures the children field is a list (not a single NodeInfo instance).
Called automatically by Pydantic during model instantiation and validation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to validate, expected to be list[NodeInfo] or None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated list of NodeInfo instances or None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If v is not None and not a list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Valid children list
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">child1</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">child2</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;child-2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[</span><span class="n">child1</span><span class="p">,</span> <span class="n">child2</span><span class="p">])</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="mi">2</span>
</code></pre></div></li>
<li>Invalid single NodeInfo for children
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;bad&quot;</span><span class="p">))</span>  <span class="c1"># doctest: +SKIP</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="o">...</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Children</span> <span class="n">must</span> <span class="n">be</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">NodeInfo</span> <span class="n">objects</span>
</code></pre></div></li>
<li>Empty children list is valid
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">children</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">[]</span>
</code></pre></div></li>
</ul>


<details class="note" open>
  <summary>Note</summary>
  <p>This validator is specific to the children field, which represents
one-to-many relationships.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_children_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NodeInfo</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that children field contains a list of NodeInfo objects.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">    Ensures the children field is a list (not a single NodeInfo instance).</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    Called automatically by Pydantic during model instantiation and validation.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        v: Value to validate, expected to be list[NodeInfo] or None.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        The validated list of NodeInfo instances or None.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        ValueError: If v is not None and not a list.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        - Valid children list</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            &gt;&gt;&gt; child1 = NodeInfo(id=&quot;child-1&quot;)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            &gt;&gt;&gt; child2 = NodeInfo(id=&quot;child-2&quot;)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(children=[child1, child2])</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            &gt;&gt;&gt; len(links.children)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            2</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            ```</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        - Invalid single NodeInfo for children</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            &gt;&gt;&gt; LinkedNodes(children=NodeInfo(id=&quot;bad&quot;))  # doctest: +SKIP</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            Traceback (most recent call last):</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">                ...</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            ValueError: Children must be a list of NodeInfo objects</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            ```</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        - Empty children list is valid</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(children=[])</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            &gt;&gt;&gt; links.children</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            []</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">            ```</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        This validator is specific to the children field, which represents</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        one-to-many relationships.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Children must be a list of NodeInfo objects&quot;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.LinkedNodes.validate_single_node" class="doc doc-heading"><a href="#serapeum.core.embeddings.LinkedNodes.validate_single_node" class="toclink">
            <code class="highlight language-python"><span class="n">validate_single_node</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.LinkedNodes.validate_single_node" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Validate that single-node fields contain NodeInfo objects.</p>
<p>Ensures that source, previous, next, and parent fields contain exactly
one NodeInfo instance (not a list). Called automatically by Pydantic
during model instantiation and validation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to validate, expected to be NodeInfo or None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code&gt;NodeInfo&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.types.NodeInfo&lt;/code&gt;)" href="#serapeum.core.embeddings.NodeInfo">NodeInfo</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated NodeInfo instance or None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If v is not None and not a NodeInfo instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Valid single node assignment
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinkedNodes</span><span class="p">,</span> <span class="n">NodeInfo</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">links</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="s1">&#39;valid&#39;</span>
</code></pre></div></li>
<li>Invalid list assignment to single-node field
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">LinkedNodes</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;bad&quot;</span><span class="p">)])</span>  <span class="c1"># doctest: +SKIP</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="o">...</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">a</span> <span class="n">NodeInfo</span> <span class="nb">object</span><span class="p">,</span> <span class="ow">not</span> <span class="n">a</span> <span class="nb">list</span>
</code></pre></div></li>
</ul>


<details class="note" open>
  <summary>Note</summary>
  <p>This validator applies to: source, previous, next, parent fields.
The children field has a separate validator for list validation.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;previous&#39;</span><span class="p">,</span> <span class="s1">&#39;next&#39;</span><span class="p">,</span> <span class="s1">&#39;parent&#39;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_single_node</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NodeInfo</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that single-node fields contain NodeInfo objects.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    Ensures that source, previous, next, and parent fields contain exactly</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    one NodeInfo instance (not a list). Called automatically by Pydantic</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">    during model instantiation and validation.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        v: Value to validate, expected to be NodeInfo or None.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        The validated NodeInfo instance or None.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        ValueError: If v is not None and not a NodeInfo instance.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        - Valid single node assignment</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import LinkedNodes, NodeInfo</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            &gt;&gt;&gt; node = NodeInfo(id=&quot;valid&quot;)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            &gt;&gt;&gt; links = LinkedNodes(source=node)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            &gt;&gt;&gt; links.source.id</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            &#39;valid&#39;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">            ```</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        - Invalid list assignment to single-node field</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">            &gt;&gt;&gt; LinkedNodes(source=[NodeInfo(id=&quot;bad&quot;)])  # doctest: +SKIP</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">            Traceback (most recent call last):</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">                ...</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            ValueError: Must be a NodeInfo object, not a list</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            ```</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        This validator applies to: source, previous, next, parent fields.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        The children field has a separate validator for list validation.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">NodeInfo</span><span class="p">):</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must be a NodeInfo object, not a list&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.MetadataMode" class="doc doc-heading"><a href="#serapeum.core.embeddings.MetadataMode" class="toclink">
            <code>MetadataMode</code>


</a><a href="#serapeum.core.embeddings.MetadataMode" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>



        <p>Enumeration for controlling which metadata is included in different contexts.</p>
<p>Different use cases require different metadata visibility. For example, you
might exclude certain metadata from embeddings (to avoid semantic pollution)
while including it for LLM context (to provide additional information).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MetadataMode.ALL">ALL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include all metadata fields.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MetadataMode.EMBED">EMBED</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include only metadata for embedding generation (excludes fields
in excluded_embed_metadata_keys).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MetadataMode.LLM">LLM</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Include only metadata for LLM context (excludes fields in
excluded_llm_metadata_keys).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MetadataMode.NONE">NONE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exclude all metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Filtering metadata for embeddings
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetadataMode</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">EMBED</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">mode</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="s1">&#39;embed&#39;</span>
</code></pre></div></li>
<li>Using with node content retrieval (conceptual)
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">LLM</span> <span class="o">==</span> <span class="s2">&quot;llm&quot;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kc">True</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">MetadataMode</span><span class="o">.</span><span class="n">NONE</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kc">True</span>
</code></pre></div></li>
<li>Checking mode type
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">MetadataMode</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kc">True</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>BaseNode.get_content: Uses this mode to control metadata inclusion.
BaseNode.get_metadata_str: Filters metadata based on this mode.
BaseNode.excluded_embed_metadata_keys: Metadata excluded for EMBED mode.
BaseNode.excluded_llm_metadata_keys: Metadata excluded for LLM mode.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="k">class</span><span class="w"> </span><span class="nc">MetadataMode</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Enumeration for controlling which metadata is included in different contexts.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Different use cases require different metadata visibility. For example, you</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    might exclude certain metadata from embeddings (to avoid semantic pollution)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    while including it for LLM context (to provide additional information).</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        ALL: Include all metadata fields.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        EMBED: Include only metadata for embedding generation (excludes fields</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            in excluded_embed_metadata_keys).</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        LLM: Include only metadata for LLM context (excludes fields in</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            excluded_llm_metadata_keys).</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        NONE: Exclude all metadata.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        - Filtering metadata for embeddings</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import MetadataMode</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            &gt;&gt;&gt; mode = MetadataMode.EMBED</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            &gt;&gt;&gt; mode.value</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            &#39;embed&#39;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            ```</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        - Using with node content retrieval (conceptual)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            &gt;&gt;&gt; MetadataMode.LLM == &quot;llm&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            True</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            &gt;&gt;&gt; MetadataMode.NONE == &quot;none&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            True</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            ```</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        - Checking mode type</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            &gt;&gt;&gt; isinstance(MetadataMode.ALL, str)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            True</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            ```</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        BaseNode.get_content: Uses this mode to control metadata inclusion.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        BaseNode.get_metadata_str: Filters metadata based on this mode.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        BaseNode.excluded_embed_metadata_keys: Metadata excluded for EMBED mode.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        BaseNode.excluded_llm_metadata_keys: Metadata excluded for LLM mode.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">ALL</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">EMBED</span> <span class="o">=</span> <span class="s2">&quot;embed&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">LLM</span> <span class="o">=</span> <span class="s2">&quot;llm&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.MockEmbedding" class="doc doc-heading"><a href="#serapeum.core.embeddings.MockEmbedding" class="toclink">
            <code>MockEmbedding</code>


</a><a href="#serapeum.core.embeddings.MockEmbedding" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code&gt;BaseEmbedding&lt;/code&gt; (&lt;code&gt;serapeum.core.base.embeddings.base.BaseEmbedding&lt;/code&gt;)" href="#serapeum.core.embeddings.BaseEmbedding">BaseEmbedding</a></code></p>



        <p>Mock embedding model for testing purposes.</p>
<p>Returns constant embedding vectors (all 0.5 values) for any input,
allowing tests to run without requiring a real embedding model. This is
useful for unit testing, integration testing, and development without
the overhead of loading actual models or making API calls.</p>
<p>All embeddings returned are deterministic vectors of the specified dimension,
filled with 0.5 values. This makes tests reproducible and fast.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MockEmbedding.embed_dim">embed_dim</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Embedding dimension (must be positive).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.MockEmbedding.model_name">model_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model name identifier (defaults to "mock-embedding").</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>
<p>Creating a mock embedding model
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MockEmbedding</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span> <span class="o">=</span> <span class="n">MockEmbedding</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span><span class="o">.</span><span class="n">model_name</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="s1">&#39;mock-embedding&#39;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span><span class="o">.</span><span class="n">embed_dim</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="mi">3</span>
</code></pre></div></p>
</li>
<li>
<p>Getting embeddings returns constant vectors
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span> <span class="o">=</span> <span class="n">MockEmbedding</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">emb</span><span class="o">.</span><span class="n">get_text_embedding</span><span class="p">(</span><span class="s2">&quot;any text&quot;</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">result</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
</code></pre></div></p>
</li>
<li>
<p>All inputs produce identical embeddings
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span> <span class="o">=</span> <span class="n">MockEmbedding</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">emb</span><span class="o">.</span><span class="n">get_text_embedding</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">emb</span><span class="o">.</span><span class="n">get_text_embedding</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kc">True</span>
</code></pre></div></p>
</li>
<li>
<p>Validation of embed_dim
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">MockEmbedding</span><span class="p">(</span><span class="n">embed_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="o">...</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">:</span> <span class="mi">1</span> <span class="n">validation</span> <span class="n">error</span><span class="o">...</span>
</code></pre></div></p>
</li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>BaseEmbedding: Abstract base class that MockEmbedding implements.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">MockEmbedding</span><span class="p">(</span><span class="n">BaseEmbedding</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mock embedding model for testing purposes.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Returns constant embedding vectors (all 0.5 values) for any input,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    allowing tests to run without requiring a real embedding model. This is</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    useful for unit testing, integration testing, and development without</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    the overhead of loading actual models or making API calls.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    All embeddings returned are deterministic vectors of the specified dimension,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    filled with 0.5 values. This makes tests reproducible and fast.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        embed_dim: Embedding dimension (must be positive).</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        model_name: Model name identifier (defaults to &quot;mock-embedding&quot;).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        - Creating a mock embedding model</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            &gt;&gt;&gt; emb = MockEmbedding(embed_dim=3)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            &gt;&gt;&gt; emb.model_name</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            &#39;mock-embedding&#39;</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            &gt;&gt;&gt; emb.embed_dim</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            3</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            ```</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        - Getting embeddings returns constant vectors</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            &gt;&gt;&gt; emb = MockEmbedding(embed_dim=4)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            &gt;&gt;&gt; result = emb.get_text_embedding(&quot;any text&quot;)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            &gt;&gt;&gt; result</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            [0.5, 0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            ```</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        - All inputs produce identical embeddings</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            &gt;&gt;&gt; emb = MockEmbedding(embed_dim=2)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            &gt;&gt;&gt; emb.get_text_embedding(&quot;hello&quot;) == emb.get_text_embedding(&quot;world&quot;)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            True</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            ```</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        - Validation of embed_dim</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            &gt;&gt;&gt; MockEmbedding(embed_dim=0)  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            Traceback (most recent call last):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">                ...</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            pydantic_core._pydantic_core.ValidationError: 1 validation error...</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            ```</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        BaseEmbedding: Abstract base class that MockEmbedding implements.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">embed_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Embedding dimension (must be positive)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;mock-embedding&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Model name identifier&quot;</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_embed_dim</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate that embed_dim is positive.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            v: The embed_dim value to validate.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            The validated embed_dim.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            ValueError: If embed_dim is not positive.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;embed_dim must be positive, got </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">return</span> <span class="n">v</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the class name identifier.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            String &quot;MockEmbedding&quot; identifying this class.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            - Getting the class name</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">                &gt;&gt;&gt; MockEmbedding.class_name()</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">                &#39;MockEmbedding&#39;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                ```</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">return</span> <span class="s2">&quot;MockEmbedding&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_mocked_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a mock embedding vector of constant values.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        Creates a vector of length embed_dim where all values are 0.5. This is</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        the core method that all other embedding methods delegate to.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            List of floats with length equal to embed_dim, all values 0.5.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            - Generating a mock vector</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=5)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">                &gt;&gt;&gt; emb._get_mocked_vector()</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">                [0.5, 0.5, 0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">                ```</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            - Vector length matches embed_dim</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=3)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">                &gt;&gt;&gt; len(emb._get_mocked_vector())</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                3</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                ```</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">return</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_dim</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get query embedding (returns constant mock vector).</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        This method ignores the input query and always returns the same mock</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        vector. Implements the abstract method from BaseEmbedding.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            query: Query text (unused in mock implementation).</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            Mock embedding vector with all values set to 0.5.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            - Query embedding returns mock vector</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=3)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                &gt;&gt;&gt; emb._get_query_embedding(&quot;test query&quot;)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                [0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">                ```</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            - Different queries return identical vectors</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=2)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                &gt;&gt;&gt; emb._get_query_embedding(&quot;query1&quot;) == emb._get_query_embedding(&quot;query2&quot;)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                True</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                ```</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mocked_vector</span><span class="p">()</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get text embedding (returns constant mock vector).</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        This method ignores the input text and always returns the same mock</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        vector. Implements the abstract method from BaseEmbedding.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            text: Input text (unused in mock implementation).</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            Mock embedding vector with all values set to 0.5.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            - Text embedding returns mock vector</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=4)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">                &gt;&gt;&gt; emb._get_text_embedding(&quot;sample text&quot;)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">                [0.5, 0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                ```</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            - Different texts return identical vectors</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=2)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">                &gt;&gt;&gt; emb._get_text_embedding(&quot;text1&quot;) == emb._get_text_embedding(&quot;text2&quot;)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                True</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">                ```</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mocked_vector</span><span class="p">()</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_query_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously get query embedding (returns constant mock vector).</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        Async version of _get_query_embedding. This method ignores the input</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        query and always returns the same mock vector. Implements the abstract</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        method from BaseEmbedding.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            query: Query text (unused in mock implementation).</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            Mock embedding vector with all values set to 0.5.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            - Async query embedding</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">                &gt;&gt;&gt; import asyncio</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=3)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">                &gt;&gt;&gt; asyncio.run(emb._aget_query_embedding(&quot;async query&quot;))</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">                [0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">                ```</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mocked_vector</span><span class="p">()</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aget_text_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Embedding</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronously get text embedding (returns constant mock vector).</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        Async version of _get_text_embedding. This method ignores the input</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        text and always returns the same mock vector. Implements the abstract</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        method from BaseEmbedding.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            text: Input text (unused in mock implementation).</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            Mock embedding vector with all values set to 0.5.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            - Async text embedding</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                &gt;&gt;&gt; import asyncio</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">                &gt;&gt;&gt; emb = MockEmbedding(embed_dim=3)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">                &gt;&gt;&gt; asyncio.run(emb._aget_text_embedding(&quot;async text&quot;))</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">                [0.5, 0.5, 0.5]</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">                ```</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mocked_vector</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.MockEmbedding.class_name" class="doc doc-heading"><a href="#serapeum.core.embeddings.MockEmbedding.class_name" class="toclink">
            <code class="highlight language-python"><span class="n">class_name</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.MockEmbedding.class_name" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Return the class name identifier.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String "MockEmbedding" identifying this class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Getting the class name
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">MockEmbedding</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">MockEmbedding</span><span class="o">.</span><span class="n">class_name</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="s1">&#39;MockEmbedding&#39;</span>
</code></pre></div></li>
</ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="k">def</span><span class="w"> </span><span class="nf">class_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the class name identifier.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        String &quot;MockEmbedding&quot; identifying this class.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        - Getting the class name</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.embeddings import MockEmbedding</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            &gt;&gt;&gt; MockEmbedding.class_name()</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            &#39;MockEmbedding&#39;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            ```</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">return</span> <span class="s2">&quot;MockEmbedding&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.MockEmbedding.validate_embed_dim" class="doc doc-heading"><a href="#serapeum.core.embeddings.MockEmbedding.validate_embed_dim" class="toclink">
            <code class="highlight language-python"><span class="n">validate_embed_dim</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.MockEmbedding.validate_embed_dim" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Validate that embed_dim is positive.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>v</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The embed_dim value to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated embed_dim.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If embed_dim is not positive.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;embed_dim&quot;</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_embed_dim</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that embed_dim is positive.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        v: The embed_dim value to validate.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        The validated embed_dim.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ValueError: If embed_dim is not positive.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;embed_dim must be positive, got </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.NodeInfo" class="doc doc-heading"><a href="#serapeum.core.embeddings.NodeInfo" class="toclink">
            <code>NodeInfo</code>


</a><a href="#serapeum.core.embeddings.NodeInfo" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="serapeum.core.types.SerializableModel">SerializableModel</span></code></p>



        <p>Lightweight reference to a node with essential identification metadata.</p>
<p>NodeInfo provides a compact representation of a node without its full content,
useful for creating references and relationships between nodes. It includes
the node's ID, content type, metadata, and optional hash for change detection.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeInfo.id">id</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the node.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeInfo.type">type</span></code></td>
            <td>
                  <code><span title="typing.Annotated">Annotated</span>[<span title="serapeum.core.base.embeddings.types.NodeContentType">NodeContentType</span>, <span title="serapeum.core.base.embeddings.types.EnumNameSerializer">EnumNameSerializer</span>] | <span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Content type classification (NodeContentType enum or string).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeInfo.metadata">metadata</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary metadata dictionary for the node.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeInfo.hash">hash</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional hash value for detecting content changes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Creating a basic node reference
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">NodeInfo</span><span class="p">,</span> <span class="n">NodeContentType</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ref</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">...</span>     <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;doc-456&quot;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">...</span>     <span class="nb">type</span><span class="o">=</span><span class="n">NodeContentType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">...</span>     <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ref</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="s1">&#39;doc-456&#39;</span>
</code></pre></div></li>
<li>Serialization and deserialization
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ref</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;node-1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">NodeContentType</span><span class="o">.</span><span class="n">DOCUMENT</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">json_str</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">restored</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">restored</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="s1">&#39;node-1&#39;</span>
</code></pre></div></li>
<li>Using with hash for change detection
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;Sample text&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">content_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ref</span> <span class="o">=</span> <span class="n">NodeInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;node-2&quot;</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">content_hash</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">ref</span><span class="o">.</span><span class="n">hash</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>  <span class="c1"># First 8 chars of hash  # doctest: +SKIP</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="s1">&#39;e3b0c442&#39;</span>
</code></pre></div></li>
</ul>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>BaseNode: Full node implementation that generates NodeInfo.
LinkedNodes: Container for node relationships using NodeInfo.
SerializableModel: Base class providing serialization methods.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="k">class</span><span class="w"> </span><span class="nc">NodeInfo</span><span class="p">(</span><span class="n">SerializableModel</span><span class="p">):</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lightweight reference to a node with essential identification metadata.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    NodeInfo provides a compact representation of a node without its full content,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    useful for creating references and relationships between nodes. It includes</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    the node&#39;s ID, content type, metadata, and optional hash for change detection.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        id: Unique identifier for the node.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        type: Content type classification (NodeContentType enum or string).</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        metadata: Arbitrary metadata dictionary for the node.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        hash: Optional hash value for detecting content changes.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        - Creating a basic node reference</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import NodeInfo, NodeContentType</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            &gt;&gt;&gt; ref = NodeInfo(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            ...     id=&quot;doc-456&quot;,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            ...     type=NodeContentType.TEXT,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            ...     metadata={&quot;page&quot;: 1}</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            &gt;&gt;&gt; ref.id</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            &#39;doc-456&#39;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            ```</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        - Serialization and deserialization</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            &gt;&gt;&gt; ref = NodeInfo(id=&quot;node-1&quot;, type=NodeContentType.DOCUMENT)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            &gt;&gt;&gt; json_str = ref.to_json()</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            &gt;&gt;&gt; restored = NodeInfo.from_json(json_str)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            &gt;&gt;&gt; restored.id</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            &#39;node-1&#39;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            ```</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        - Using with hash for change detection</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            &gt;&gt;&gt; import hashlib</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            &gt;&gt;&gt; content = &quot;Sample text&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            &gt;&gt;&gt; content_hash = hashlib.sha256(content.encode()).hexdigest()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            &gt;&gt;&gt; ref = NodeInfo(id=&quot;node-2&quot;, hash=content_hash)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            &gt;&gt;&gt; ref.hash[:8]  # First 8 chars of hash  # doctest: +SKIP</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            &#39;e3b0c442&#39;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            ```</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        BaseNode: Full node implementation that generates NodeInfo.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        LinkedNodes: Container for node relationships using NodeInfo.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        SerializableModel: Base class providing serialization methods.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="nb">type</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">NodeContentType</span><span class="p">,</span> <span class="n">EnumNameSerializer</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="nb">hash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the class name identifier for serialization.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            Always returns &quot;NodeInfo&quot; as the stable class identifier.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            - Getting class name</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">                &gt;&gt;&gt; from serapeum.core.base.embeddings.types import NodeInfo</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">                &gt;&gt;&gt; NodeInfo.class_name()</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">                &#39;NodeInfo&#39;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">                ```</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">return</span> <span class="s2">&quot;NodeInfo&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="serapeum.core.embeddings.NodeInfo.class_name" class="doc doc-heading"><a href="#serapeum.core.embeddings.NodeInfo.class_name" class="toclink">
            <code class="highlight language-python"><span class="n">class_name</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</a><a href="#serapeum.core.embeddings.NodeInfo.class_name" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Return the class name identifier for serialization.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always returns "NodeInfo" as the stable class identifier.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Getting class name
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">serapeum.core.base.embeddings.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">NodeInfo</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">NodeInfo</span><span class="o">.</span><span class="n">class_name</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="s1">&#39;NodeInfo&#39;</span>
</code></pre></div></li>
</ul>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="k">def</span><span class="w"> </span><span class="nf">class_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the class name identifier for serialization.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Always returns &quot;NodeInfo&quot; as the stable class identifier.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        - Getting class name</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            &gt;&gt;&gt; from serapeum.core.base.embeddings.types import NodeInfo</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            &gt;&gt;&gt; NodeInfo.class_name()</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            &#39;NodeInfo&#39;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            ```</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="s2">&quot;NodeInfo&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="serapeum.core.embeddings.NodeType" class="doc doc-heading"><a href="#serapeum.core.embeddings.NodeType" class="toclink">
            <code>NodeType</code>


</a><a href="#serapeum.core.embeddings.NodeType" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>



        <p>Node links used in <code>BaseNode</code> class.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeType.SOURCE">SOURCE</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node is the source document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeType.PREVIOUS">PREVIOUS</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node is the previous node in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeType.NEXT">NEXT</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node is the next node in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeType.PARENT">PARENT</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node is the parent node in the document.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="serapeum.core.embeddings.NodeType.CHILD">CHILD</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node is a child node in the document.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>libs/core/src/serapeum/core/base/embeddings/types.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="k">class</span><span class="w"> </span><span class="nc">NodeType</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Node links used in `BaseNode` class.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        SOURCE: The node is the source document.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        PREVIOUS: The node is the previous node in the document.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        NEXT: The node is the next node in the document.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        PARENT: The node is the parent node in the document.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        CHILD: The node is a child node in the document.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">SOURCE</span> <span class="o">=</span> <span class="s2">&quot;source&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">PREVIOUS</span> <span class="o">=</span> <span class="s2">&quot;previous&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">NEXT</span> <span class="o">=</span> <span class="s2">&quot;next&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">PARENT</span> <span class="o">=</span> <span class="s2">&quot;parent&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">CHILD</span> <span class="o">=</span> <span class="s2">&quot;child&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../llms/orchestrators/tool_orchestrating_llm/tool_orchestrating_llm_state/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lifecycle">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lifecycle
              </div>
            </div>
          </a>
        
        
          
          <a href="../../tools/tools/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Serapieum-of-alex/Serapeum" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.indexes", "navigation.footer", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "content.code.copy", "content.code.annotate", "content.action.edit", "content.action.view", "content.tooltips", "search.highlight", "search.suggest", "toc.follow", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../assets/javascripts/panzoom.min.js"></script>
      
        <script src="../../../../assets/javascripts/zoompan.js"></script>
      
    
  </body>
</html>